<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VERICORE Industrial Machine Management System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #000000;
            color: #ffffff;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #333;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffffff;
            text-decoration: none;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: #333;
            border: none;
            color: #fff;
            padding: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: #555;
        }

        .profile-section {
            position: relative;
        }

        .profile-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .profile-btn:hover {
            background: #333;
        }

        .profile-img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
        }

        .profile-name {
            font-weight: 500;
        }

        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: #222;
            border: 1px solid #333;
            border-radius: 8px;
            min-width: 200px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1001;
        }

        .profile-dropdown.show {
            display: block;
        }

        .profile-dropdown a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            color: inherit;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .profile-dropdown a:hover {
            background: #333;
        }

        .profile-dropdown hr {
            border: none;
            border-top: 1px solid #333;
            margin: 0.5rem 0;
        }

        /* Language dropdown */
        .language-dropdown {
            position: absolute;
            top: 0;
            left: 100%;
            background: #222;
            border: 1px solid #333;
            border-radius: 8px;
            min-width: 150px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1002;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-dropdown a {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            color: inherit;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .language-dropdown a:hover {
            background: #333;
        }

        /* Stats Page */
        .stats-page {
            padding-top: 80px;
            min-height: 100vh;
            background: #000000;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            padding: 2rem;
        }

        .stat-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            min-height: 150px;
        }

        .stat-card::before {
            content: attr(data-enum);
            position: absolute;
            top: -10px;
            left: -10px;
            width: 24px;
            height: 24px;
            background: #ff8c00;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            font-size: 0.8rem;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
            z-index: 1;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(255, 140, 0, 0.2);
            border-color: #ff8c00;
        }

        .stat-card:hover::before {
            opacity: 1;
            transform: scale(1);
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #FFC107;
            margin: 0.5rem 0;
        }

        .stat-card .description {
            color: #999;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .stat-card canvas {
            margin-top: 1rem;
            width: 100% !important;
            height: 60px !important;
        }

        .stat-card .chart-label {
            color: #666;
            font-size: 0.8rem;
            margin-top: 0.5rem;
            text-align: center;
        }

        .stat-card .mini-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #333;
        }

        /* Login Page */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #000000 0%, #333333 100%);
        }

        .login-container {
            padding: 2rem;
        }

        .login-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 16px;
            padding: 3rem;
            text-align: center;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .login-header {
            margin-bottom: 2rem;
        }

        .logo-circle {
            width: 64px;
            height: 64px;
            background: #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff;
        }

        .login-header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .login-header p {
            color: #999;
            font-size: 0.9rem;
        }

        .google-login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.75rem 1.5rem;
            background: #fff;
            color: #333;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .google-login-btn:hover {
            background: #f8f8f8;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .google-icon {
            width: 20px;
            height: 20px;
        }

        /* Main Content */
        .main-content {
            padding-top: 80px;
            min-height: 100vh;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem 0;
        }

        .dashboard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .dashboard-header p {
            color: #999;
            font-size: 1.1rem;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: #ff8c00;
            color: #fff;
        }

        .btn-primary:hover {
            background: #ff9933;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #333;
            color: #fff;
        }

        .btn-secondary:hover {
            background: #555;
        }

        .btn-accent {
            background: #666;
            color: #fff;
        }

        .btn-accent:hover {
            background: #777;
        }

        .btn-outline {
            background: transparent;
            color: #fff;
            border: 2px dashed #666;
        }

        .btn-outline:hover {
            border-color: #fff;
            background: rgba(255, 255, 255, 0.1);
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        /* Machine Cards */
        .machine-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .machine-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .machine-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.1);
            border-color: #666;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 1.5rem;
        }

        .card-icon.milling {
            background: #ff8c00;
        }

        .card-icon.grinding {
            background: #ff9933;
        }

        .card-icon.cutting {
            background: #ffaa4d;
        }

        .card-stats {
            text-align: right;
        }

        .count {
            font-size: 2rem;
            font-weight: bold;
            color: #fff;
        }

        .label {
            font-size: 0.9rem;
            color: #999;
        }

        .machine-card h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .machine-card p {
            color: #999;
            margin-bottom: 1.5rem;
        }

        .card-footer {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #999;
            font-size: 0.9rem;
        }

        /* Stats Card */
        .stats-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
        }

        .stats-card h2 {
            margin-bottom: 1.5rem;
            color: #fff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #999;
            font-size: 0.9rem;
        }

        /* Machine Type View */
        .machine-type-view,
        .machine-details-view,
        .analytics-page,
        .operators-view,
        .insights-page {
            padding-top: 80px;
            min-height: 100vh;
        }

        /* Prediction Interface */
        .prediction-interface {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .prediction-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .prediction-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 1.5rem;
            background: #ff8c00;
        }

        .prediction-title {
            font-size: 1.5rem;
            color: #fff;
            margin: 0;
        }

        .wear-progression {
            margin-bottom: 2rem;
        }

        .wear-progression h3 {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .wear-chart {
            background: #000;
            border: 2px dashed #444;
            border-radius: 8px;
            height: 150px;
            position: relative;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .wear-line {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            height: 2px;
            background: linear-gradient(to right, #4CAF50, #FFC107, #FF5722);
            border-radius: 1px;
        }

        .wear-indication-zone {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px dashed #666;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            color: #ccc;
            font-size: 0.8rem;
        }

        .condition-trigger {
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .condition-trigger h3 {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ai-prediction {
            margin-bottom: 2rem;
        }

        .ai-prediction h3 {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .prediction-content {
            color: #fff;
            line-height: 1.6;
        }

        .shift-comparison {
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .shift-comparison h3 {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .shift-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .shift-note {
            color: #999;
            font-size: 0.9rem;
            margin-top: 1rem;
            font-style: italic;
        }

        .warning-thresholds {
            display: flex;
            gap: 1rem;
        }

        .threshold-btn {
            flex: 1;
            padding: 1rem;
            background: #333;
            border: 1px solid #555;
            border-radius: 8px;
            color: #fff;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .threshold-btn:hover {
            background: #444;
            border-color: #ff8c00;
        }

        .threshold-btn.active {
            background: #ff8c00;
            border-color: #ff8c00;
        }

        /* Temperature Monitoring Interface */
        .temperature-interface {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .temp-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .temp-live {
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
        }

        .temp-live h3 {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .temp-value {
            font-size: 3rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 0.5rem;
        }

        .temp-status {
            color: #4CAF50;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .temp-change {
            color: #FFC107;
            font-size: 0.9rem;
        }

        .temp-chart {
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
        }

        .temp-chart h3 {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .temp-graph {
            background: #000;
            border: 1px solid #333;
            border-radius: 4px;
            height: 120px;
            position: relative;
            margin-bottom: 1rem;
        }

        .temp-trend-line {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            height: 2px;
            background: linear-gradient(to right, #4CAF50, #FFC107, #FF5722);
            border-radius: 1px;
        }

        .temp-threshold {
            position: absolute;
            top: 40px;
            left: 20px;
            right: 20px;
            height: 1px;
            border-top: 2px dashed #666;
        }

        .temp-axis {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 0.8rem;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .root-cause, .shift-context {
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
        }

        .root-cause h3, .shift-context h3 {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cause-list {
            list-style: none;
            margin-bottom: 1rem;
        }

        .cause-list li {
            color: #fff;
            margin-bottom: 0.5rem;
            position: relative;
            padding-left: 1rem;
        }

        .cause-list li:before {
            content: "•";
            color: #ff8c00;
            position: absolute;
            left: 0;
        }

        .context-chart {
            background: #000;
            border: 1px solid #333;
            border-radius: 4px;
            height: 100px;
            margin-bottom: 1rem;
            position: relative;
        }

        .context-bars {
            display: flex;
            align-items: end;
            height: 80px;
            padding: 10px;
            gap: 8px;
        }

        .context-bar {
            background: #ff8c00;
            flex: 1;
            border-radius: 2px 2px 0 0;
        }

        .context-bar:nth-child(1) { height: 30%; }
        .context-bar:nth-child(2) { height: 35%; }
        .context-bar:nth-child(3) { height: 50%; }
        .context-bar:nth-child(4) { height: 70%; }
        .context-bar:nth-child(5) { height: 85%; }

        .context-labels {
            display: flex;
            justify-content: space-between;
            color: #666;
            font-size: 0.8rem;
            padding: 0 10px;
        }

        .export-btn {
            background: #333;
            border: 1px solid #555;
            border-radius: 6px;
            color: #fff;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .export-btn:hover {
            background: #444;
            border-color: #ff8c00;
        }

        /* Shift-Start Delay Interface */
        .shift-start-delay-interface {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .delay-chart-section {
            margin: 2rem 0;
        }

        .delay-chart-section h3 {
            color: #ccc;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
        }

        .chart-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .view-selector {
            background: #222;
            border: 1px solid #444;
            border-radius: 6px;
            color: #fff;
            padding: 0.5rem 1rem;
        }

        .threshold-control {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .threshold-input {
            background: #222;
            border: 1px solid #444;
            border-radius: 6px;
            color: #fff;
            padding: 0.5rem 1rem;
            width: 180px;
        }

        .delay-chart-container {
            background: #000;
            border: 2px dashed #444;
            border-radius: 8px;
            height: 240px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .delay-analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .operator-analysis, .contributing-factors {
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
        }

        .operator-analysis h3, .contributing-factors h3 {
            color: #ccc;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
        }

        .operator-delays {
            margin-bottom: 2rem;
        }

        .operator-delay-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .delay-time {
            color: #FFC107;
        }

        .alert-options {
            margin-top: 1rem;
        }

        .alert-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #fff;
            margin-bottom: 0.5rem;
        }

        .alert-option i {
            color: #FFC107;
        }

        .factor-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .factor-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #fff;
        }

        .factor-item .checkbox {
            width: 20px;
            height: 20px;
            border: 1px solid #444;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .factor-item.checked .checkbox {
            background: rgba(255, 193, 7, 0.2);
            border-color: #FFC107;
        }

        .factor-item.checked .checkbox i {
            color: #FFC107;
        }

        /* Historical Trend Interface */
        .historical-interface {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .historical-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .historical-title {
            color: #ccc;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .historical-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .view-toggle {
            background: #333;
            border: 1px solid #555;
            border-radius: 6px;
            color: #fff;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .view-toggle:hover {
            background: #444;
        }

        .historical-chart {
            background: #000;
            border: 1px solid #333;
            border-radius: 8px;
            height: 200px;
            margin-bottom: 2rem;
            position: relative;
            padding: 20px;
        }

        .chart-lines {
            position: relative;
            height: 100%;
        }

        .changeover-line, .idle-line {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            border-radius: 1px;
        }

        .changeover-line {
            background: linear-gradient(90deg, #ff8c00, #ff9933, #ffaa4d);
            bottom: 60px;
        }

        .idle-line {
            background: linear-gradient(90deg, #666, #777, #888);
            bottom: 40px;
        }

        .chart-legend {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #ccc;
            font-size: 0.9rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .legend-color {
            width: 20px;
            height: 2px;
            border-radius: 1px;
        }

        .legend-color.changeover {
            background: #ff8c00;
        }

        .legend-color.idle {
            background: #666;
        }

        .bottom-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 2rem;
        }

        .operators-section, .prediction-section, .prediction-box {
            background: #222;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1.5rem;
        }

        .section-title {
            color: #ccc;
            margin-bottom: 1rem;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .operator-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
            color: #fff;
            font-size: 0.9rem;
        }

        .prediction-factor {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            color: #fff;
            font-size: 0.9rem;
        }

        .checkbox {
            width: 16px;
            height: 16px;
            border: 1px solid #555;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff8c00;
        }

        .checkbox.checked {
            background: rgba(255, 140, 0, 0.2);
        }

        .prediction-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fff;
            text-align: center;
            margin: 1rem 0;
        }

        .prediction-label {
            color: #ccc;
            text-align: center;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .suggestions-list {
            list-style: none;
        }

        .suggestions-list li {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            color: #fff;
            font-size: 0.9rem;
        }

        .view-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            color: #fff;
        }

        .view-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .type-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 1.5rem;
            background: #ff8c00;
        }

        .view-title h1 {
            font-size: 2rem;
            color: #fff;
        }

        .view-title p {
            color: #999;
        }

        .machines-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .machine-item {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .machine-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        .machine-item h3 {
            color: #fff;
            margin-bottom: 0.5rem;
        }

        .machine-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            background: #333;
            color: #fff;
        }

        /* Machine Details */
        .machine-info-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .machine-info-card h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #fff;
        }

        .machine-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .machine-type-badge {
            padding: 0.5rem 1rem;
            background: #ff8c00;
            color: #fff;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .machine-date {
            color: #999;
            font-size: 0.9rem;
        }

        .machine-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .stat-card {
            background: #222;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
        }

        .stat-card i {
            font-size: 1.5rem;
            color: #ff8c00;
            margin-bottom: 0.5rem;
        }

        /* Tabs */
        .view-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: #222;
            border: none;
            color: #999;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn.active,
        .tab-btn:hover {
            background: #ff8c00;
            color: #fff;
        }

        .tab-content {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-top: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #333;
        }

        th {
            font-weight: 600;
            color: #fff;
            background: #222;
        }

        td {
            color: #fff;
        }

        /* Charts */
        .chart-controls,
        .chart-metric-selector {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .chart-btn,
        .metric-btn {
            padding: 0.5rem 1rem;
            background: #222;
            border: none;
            color: #999;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .chart-btn.active,
        .chart-btn:hover,
        .metric-btn.active,
        .metric-btn:hover {
            background: #ff8c00;
            color: #fff;
        }

        .chart-container {
            height: 300px;
            margin-top: 1rem;
        }

        .analytics-container {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
        }

        /* Analytics Page */
        .time-range-selector {
            display: flex;
            gap: 0.5rem;
        }

        .time-btn {
            padding: 0.5rem 1rem;
            background: #222;
            border: none;
            color: #999;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .time-btn.active,
        .time-btn:hover {
            background: #ff8c00;
            color: #fff;
        }

        .analytics-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .analytics-stat-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .analytics-stat-card i {
            font-size: 1.5rem;
            color: #ff8c00;
        }

        .analytics-charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .chart-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
        }

        .chart-card h3 {
            margin-bottom: 1rem;
            color: #fff;
        }

        .chart-card canvas {
            max-height: 300px;
        }

        .top-machines-table {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
        }

        .top-machines-table h3 {
            margin-bottom: 1rem;
            color: #fff;
        }

        /* Operator Badges */
        .operator-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .badge-trainee {
            background: #c0c0c0;
            color: #333;
        }

        .badge-skilled {
            background: #cd7f32;
            color: #fff;
        }

        .badge-precision {
            background: #0077ff;
            color: #fff;
        }

        .badge-veteran {
            background: #28a745;
            color: #fff;
            position: relative;
            overflow: hidden;
        }

        .badge-veteran::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ff8a00, #ff0058);
        }

        .badge-whisperer {
            background: #dc3545;
            color: #fff;
            position: relative;
        }

        .badge-whisperer::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 22px;
            border: 2px solid #dc3545;
            animation: pulse 2s infinite;
        }

        .badge-master {
            background: linear-gradient(90deg, #ff8a00, #ff0058);
            color: #fff;
            position: relative;
        }

        .badge-master::before {
            content: '\f1af';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2em;
            opacity: 0.2;
        }

        .badge-champion {
            background: linear-gradient(90deg, #ffd700, #ff8a00);
            color: #333;
            border: 2px solid #ff8a00;
            position: relative;
        }

        .badge-champion::before {
            content: '\f005';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2em;
            opacity: 0.2;
        }

        .badge-legendary {
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            color: #fff;
            position: relative;
            animation: glow 2s infinite alternate;
        }

        .badge-legendary::before {
            content: '\f521';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2em;
            opacity: 0.2;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.02); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }

        @keyframes glow {
            from {
                box-shadow: 0 0 5px #00d2ff;
            }
            to {
                box-shadow: 0 0 20px #3a7bd5;
            }
        }

        /* Operator Cards */
        .operator-card {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .operator-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        .operator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .operator-name {
            font-size: 1.2rem;
            font-weight: 500;
            color: #fff;
        }

        .operator-stats {
            display: flex;
            gap: 1rem;
        }

        .operator-stat {
            text-align: center;
        }

        .operator-stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ff8c00;
        }

        .operator-stat-label {
            font-size: 0.8rem;
            color: #999;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: #111;
            border: 1px solid #333;
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-large {
            max-width: 800px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 2rem 1rem;
            border-bottom: 1px solid #333;
        }

        .modal-header h2 {
            color: #fff;
        }

        .close-btn {
            background: none;
            border: none;
            color: #999;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            color: #fff;
            background: #333;
        }

        .modal form {
            padding: 2rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #333;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #fff;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #333;
            border-radius: 6px;
            background: #222;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #666;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
        }

        .error-message {
            color: #ff6b6b;
            font-size: 0.9rem;
            margin-top: 0.25rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .form-group.error input,
        .form-group.error select,
        .form-group.error textarea {
            border-color: #ff6b6b;
        }

        /* Machine Slots */
        .machine-slot {
            background: #222;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
        }

        .slot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .slot-title {
            font-weight: 500;
            color: #fff;
        }

        .remove-slot-btn {
            background: none;
            border: none;
            color: #ff6b6b;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .remove-slot-btn:hover {
            background: rgba(255, 107, 107, 0.1);
        }

        .slot-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            color: #fff;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 3000;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.success {
            background: #28a745;
        }

        .notification.error {
            background: #dc3545;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                padding: 1rem;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .machine-cards {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .view-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .machine-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .analytics-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .analytics-charts-grid {
                grid-template-columns: 1fr;
            }
            
            .slot-fields {
                grid-template-columns: 1fr;
            }
            
            .modal {
                padding: 1rem;
            }
            
            .modal form {
                padding: 1rem;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .machine-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .view-tabs {
                flex-direction: column;
            }
            
            .time-range-selector {
                flex-wrap: wrap;
            }
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #333;
            border-top: 2px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        .p-1 { padding: 0.5rem; }
        .p-2 { padding: 1rem; }
        .p-3 { padding: 1.5rem; }
        .p-4 { padding: 2rem; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="logo">VERICORE</h1>
            <div class="header-right">
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="profile-section">
                    <button class="profile-btn" id="profileBtn">
                        <img src="https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=64&h=64&dpr=2" alt="Profile" class="profile-img">
                        <span class="profile-name">John Doe</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="profile-dropdown" id="profileDropdown">
                        <a href="#"><i class="fas fa-user"></i> <span data-translate="profile">Profile</span></a>
                        <a href="#"><i class="fas fa-credit-card"></i> <span data-translate="change_plan">Change Plan</span></a>
                        <a href="#" id="languageBtn"><i class="fas fa-globe"></i> <span data-translate="change_language">Change Language</span></a>
                        <a href="#"><i class="fas fa-cog"></i> <span data-translate="settings">Settings</span></a>
                        <hr>
                        <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> <span data-translate="logout">Logout</span></a>
                    </div>
                    <div class="language-dropdown" id="languageDropdown">
                        <a href="#" data-lang="en"><i class="fas fa-check"></i> English</a>
                        <a href="#" data-lang="hi">हिन्दी (Hindi)</a>
                        <a href="#" data-lang="ta">தமிழ் (Tamil)</a>
                        <a href="#" data-lang="te">తెలుగు (Telugu)</a>
                        <a href="#" data-lang="de">Deutsch (German)</a>
                        <a href="#" data-lang="fr">Français (French)</a>
                        <a href="#" data-lang="nl">Nederlands (Dutch)</a>
                        <a href="#" data-lang="sv">Svenska (Swedish)</a>
                        <a href="#" data-lang="el">Ελληνικά (Greek)</a>
                        <a href="#" data-lang="es">Español (Spanish)</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Login Page -->
    <div class="login-page" id="loginPage">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="logo-circle">
                        <span>V</span>
                    </div>
                    <h1 data-translate="vericore">VERICORE</h1>
                    <p data-translate="system_description">Industrial Machine Management System</p>
                </div>
                <button class="google-login-btn" id="googleLoginBtn">
                    <svg class="google-icon" viewBox="0 0 24 24">
                        <path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    <span data-translate="login_with_google">Login with Google</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div class="main-content" id="mainContent" style="display: none;">
        <div class="container">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <h1 data-translate="dashboard_title">Machine Management Dashboard</h1>
                <p data-translate="dashboard_subtitle">Monitor and manage your industrial equipment</p>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" id="addMachineBtn">
                    <i class="fas fa-plus"></i> <span data-translate="add_machine">Add Machine</span>
                </button>
                <button class="btn btn-secondary" id="addLineBtn">
                    <i class="fas fa-plus"></i> <span data-translate="add_line">Add Line of Machines</span>
                </button>
                <button class="btn btn-accent" id="insightsBtn">
                    <i class="fas fa-lightbulb"></i> <span data-translate="insights">Insights</span>
                </button>
                <button class="btn btn-accent" id="analyseBtn">
                    <i class="fas fa-chart-line"></i> <span data-translate="analyse">Analyse</span>
                </button>
                <button class="btn btn-outline" id="viewOperatorsBtn">
                    <i class="fas fa-users"></i> <span data-translate="view_operators">View Operators</span>
                </button>
                                <!-- Add this button next to the Insights button in your dashboard action-buttons section -->
                <button class="btn btn-accent" id="statsBtn">
                    <i class="fas fa-chart-pie"></i> <span>Stats</span>
                </button>
            </div>

            <!-- Quick Stats -->
            <div class="stats-card">
                <h2 data-translate="quick_stats">Quick Statistics</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="totalMachines">0</div>
                        <div class="stat-label" data-translate="total_machines">Total Machines</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="activeMachines">0</div>
                        <div class="stat-label" data-translate="active_machines">Active Machines</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalEntries">0</div>
                        <div class="stat-label" data-translate="data_entries">Data Entries</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalProducts">0</div>
                        <div class="stat-label" data-translate="products_made">Products Made</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
         <!-- Add this section after your insights page (or where you want the stats to show) -->
          <!-- Add this at the top of the .container inside #statsPage -->

    <div class="stats-page" id="statsPage" style="display:none;">
        <div class="container">
            <div class="view-header">
                <button class="back-btn" id="backToMainFromStats">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                <div class="view-title">
                    <h1>Factory Owner-centric: Insights for Grinding Machines</h1>
                    <p>Comprehensive statistics and KPIs</p>
                </div>
            </div>
            <div class="stats-grid">
                <!-- Each stat card below is hoverable and enumerated -->
                <div class="stat-card hover-enum" data-enum="1">
                    <div style="font-size:2.5rem;font-weight:bold;color:#FFC107;">85%</div>
                    <div style="margin-bottom:0.5rem;">Overall Equipment</div>
                    <div>Availability <span style="float:right;">88%</span></div>
                    <div>Performance <span style="float:right;">82%</span></div>
                    <div>Quality <span style="float:right;">94%</span></div>
                </div>
                <div class="stat-card hover-enum" data-enum="2">
                    <div>Spindle Overheating Prediction</div>
                    <div style="font-size:1.5rem;color:#FFC107;"><i class="fas fa-exclamation-triangle"></i> 23% SENSED</div>
                </div>
                <div class="stat-card hover-enum" data-enum="3">
                    <div>Chatter & Vibration Alert</div>
                    <div style="font-size:2rem;color:#FFC107;">18 <span style="font-size:1rem;">hours</span></div>
                    <div>until wheel replacing</div>
                    <div style="font-size:0.9rem;color:#ccc;">Recommended Placement</div>
                    <div style="font-size:1.2rem;color:#FFC107;">₹ 450/day</div>
                </div>
                <div class="stat-card hover-enum" data-enum="4">
                    <div>Grinding Wheel Dullness</div>
                    <div style="font-size:2rem;color:#FFC107;">18 hr</div>
                    <div>Estimates to wheel replac</div>
                </div>
                <div class="stat-card hover-enum" data-enum="5">
                    <div>Coolant Consumption Spike</div>
                    <div style="font-size:1.5rem;color:#FFC107;">→14% today</div>
                </div>
                <div class="stat-card hover-enum" data-enum="6">
                    <div>Coolant Consumption Spike</div>
                    <div style="font-size:1.5rem;color:#FFC107;">₹ 3,7 k/month</div>
                </div>
                <div class="stat-card hover-enum" data-enum="7">
                    <div>Idle Power Loss Tracking</div>
                    <div style="font-size:1.5rem;color:#FFC107;">₹ 3,7 k/tmonth</div>
                </div>
                <div class="stat-card hover-enum" data-enum="8">
                    <div>Chatter & Vibration Alert</div>
                    <div style="font-size:1.2rem;color:#FFC107;">4 occurrences this week</div>
                    <div style="font-size:0.9rem;color:#ccc;">Recommended Placement</div>
                    <div style="font-size:1.2rem;color:#FFC107;">₹ 450/day</div>
                </div>
                <div class="stat-card hover-enum" data-enum="9">
                    <div>Delayed Shift Start Report</div>
                    <div style="font-size:2rem;color:#FFC107;">4</div>
                    <div>shifts delayed per week</div>
                </div>
                <div class="stat-card hover-enum" data-enum="10">
                    <div>Labor Hours Lost to Delay</div>
                    <div style="font-size:2rem;color:#FFC107;">5:30</div>
                    <div>this week</div>
                </div>
                <div class="stat-card hover-enum" data-enum="11">
                    <div>Energy Cost Per Machine</div>
                    <div style="font-size:1.5rem;color:#FFC107;">₹ 450/day</div>
                    <canvas id="energyCostChart" style="width:100%;height:60px;"></canvas>
                    <div style="font-size:0.9rem;color:#ccc;">Jan Feb Mar Apr May Jun Sep</div>
                </div>
                <div class="stat-card hover-enum" data-enum="12">
                    <div>Delayed Shift Start Report</div>
                    <div style="font-size:2rem;color:#FFC107;">4</div>
                    <div>shifts delayed per week</div>
                    <canvas id="shiftDelayChart" style="width:100%;height:60px;"></canvas>
                </div>
                <div class="stat-card hover-enum" data-enum="13">
                    <div>Part Changeover Delay Mapping</div>
                    <canvas id="changeoverDelayChart" style="width:100%;height:60px;"></canvas>
                    <div style="font-size:0.9rem;color:#ccc;">Mon Tue Wed Thu Fri</div>
                </div>
                <div class="stat-card hover-enum" data-enum="14">
                    <div>Per-Part Energy Cost</div>
                    <canvas id="perPartEnergyChart" style="width:100%;height:60px;"></canvas>
                    <div style="font-size:0.9rem;color:#ccc;">$1 $2 $3 $3</div>
                </div>
                <div class="stat-card hover-enum" data-enum="15">
                    <div>Grinding Cycle Variation</div>
                    <canvas id="grindingCycleChart" style="width:100%;height:60px;"></canvas>
                    <div style="font-size:0.9rem;color:#ccc;">Shifts</div>
                </div>
                <div class="stat-card hover-enum" data-enum="16">
                    <div>Alert Summary by Financial Risk</div>
                    <div style="font-size:1rem;color:#FFC107;">Red orange</div>
                    <div style="font-size:1.2rem;color:#FFC107;">8 red &nbsp; 27 yellow</div>
                    <div style="font-size:1rem;color:#FFC107;">Mechim Alerts</div>
                    <div style="font-size:1.2rem;color:#FFC107;">15 yellow</div>
                </div>
                <div class="stat-card hover-enum" data-enum="17">
                    <div>ROI of Vericore System</div>
                    <div style="font-size:2.5rem;color:#FFC107;">3,1x</div>
                </div>
                <div class="stat-card hover-enum" data-enum="18">
                    <div>₹ SAVED VIA PREVENTIVE ACTIONS</div>
                    <div style="font-size:2rem;color:#FFC107;">₹ 45,200</div>
                    <div>this month</div>
                    
                </div>
            </div>

        </div>
        
    </div>


    <!-- Insights Page -->
    <div class="insights-page" id="insightsPage" style="display: none;">
        <div class="container">
            <div class="view-header">
                <button class="back-btn" id="backToMainFromInsights">
                    <i class="fas fa-arrow-left"></i> <span data-translate="back_to_dashboard">Back to Dashboard</span>
                </button>
                <div class="view-title">
                    <h1 data-translate="insights">Insights</h1>
                    <p data-translate="insights_subtitle">Machine type overview and analysis</p>
                </div>
            </div>

            <!-- Machine Type Cards -->
            <div class="machine-cards" id="machineCards">
                <div class="machine-card" data-type="Milling">
                    <div class="card-header">
                        <div class="card-icon milling">
                            <i class="fas fa-cog"></i>
                        </div>
                        <div class="card-stats">
                            <div class="count" id="millingCount">0</div>
                            <div class="label" data-translate="machines">machines</div>
                        </div>
                    </div>
                    <h3 data-translate="milling">Milling</h3>
                    <div class="machine-insights">
                        <p data-translate="milling_description">Industrial milling equipment</p>
                        <div class="card-footer">
                        <i class="fas fa-chart-bar"></i>
                        <span data-translate="view_details">View Details</span>
                    </div>
                        
                    </div>
                </div>
                
                <!-- Milling Machines Grid -->
                <div class="machines-list" id="millingMachinesList" style="display: none;">
                    <h2>Milling Machines</h2>
                    <div class="machines-grid">
                        <!-- Milling machines will be populated here -->
                    </div>
                </div>

                <div class="machine-card" data-type="Grinding">
                    <div class="card-header">
                        <div class="card-icon grinding">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="card-stats">
                            <div class="count" id="grindingCount">0</div>
                            <div class="label" data-translate="machines">machines</div>
                        </div>
                    </div>
                    <h3 data-translate="grinding">Grinding</h3>
                    <p data-translate="grinding_description">Industrial grinding equipment</p>
                    <div class="card-footer">
                        <i class="fas fa-chart-bar"></i>
                        <span data-translate="view_details">View Details</span>
                    </div>
                </div>
                <div class="machine-card" data-type="Cutting">
                    <div class="card-header">
                        <div class="card-icon cutting">
                            <i class="fas fa-cut"></i>
                        </div>
                        <div class="card-stats">
                            <div class="count" id="cuttingCount">0</div>
                            <div class="label" data-translate="machines">machines</div>
                        </div>
                    </div>
                    <h3 data-translate="cutting">Cutting</h3>
                    <p>No insights available for Cutting machines</p>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Machine Type View -->
    <div class="machine-type-view" id="machineTypeView" style="display: none;">
        <div class="container">
            <div class="view-header">
                <button class="back-btn" id="backToMain">
                    <i class="fas fa-arrow-left"></i> <span data-translate="back_to_dashboard">Back to Dashboard</span>
                </button>
                <div class="view-title">
                    <div class="type-icon" id="typeIcon">
                        <i class="fas fa-cog"></i>
                    </div>
                    <div>
                        <h1 id="machineTypeName" data-translate="milling_machines">Milling Machines</h1>
                        <p id="machineTypeCount">0 <span data-translate="machines_in_category">machines in this category</span></p>
                    </div>
                </div>
            </div>
            <div class="machines-grid" id="machinesGrid">
                <!-- Machines will be populated here -->
            </div>

            <!-- Prediction Interface -->
            <div class="prediction-interface" id="predictionInterface">
                <div class="prediction-header">
                    <div class="prediction-icon" id="predictionIcon">
                        <i class="fas fa-cog"></i>
                    </div>
                    <h2 class="prediction-title" id="predictionTitle">MILLING TOOL WEAR PREDICTION</h2>
                </div>

                <div class="wear-progression">
                    <h3>WEAR PROGRESSION TREND</h3>
                    <div class="wear-chart">
                        <div class="wear-indication-zone">WEAR INDICATION ZONE</div>
                        <div class="wear-line"></div>
                    </div>
                </div>

                <div class="condition-trigger">
                    <h3>CONDITION TRIGGER EVENTS</h3>
                    <div class="prediction-content" id="triggerEvents">
                        Tool wear detected after part #156. Related alert: 
                        Slight increase in surface roughness after wear onset
                    </div>
                </div>

                <div class="ai-prediction">
                    <h3>AI WEAR PREDICTION & RECOMMENDATION</h3>
                    <div class="prediction-content" id="aiRecommendation">
                        Predicted time to replacement: ~32 parts.<br>
                        Tool change recommended now
                    </div>
                </div>

                <div class="shift-comparison">
                    <h3>SHIFT COMPARISON</h3>
                    <div class="shift-item">
                        <span>Shift A: Avg. power draw 7.2 kW</span>
                        <span>Shift B: Avg. power draw 7.8 kW</span>
                    </div>
                    <div class="shift-item">
                        <span>Shift C: Avg. power draw 7.5 kW</span>
                        <span></span>
                    </div>
                    <div class="shift-note" id="shiftNote">
                        (more power consumption can be due to dull tool or aggressive cutting)
                    </div>
                </div>

                <div class="warning-thresholds">
                    <div class="threshold-btn" id="setThresholdBtn">
                        SET WEAR WARNING THRESHOLD
                    </div>
                    <div class="threshold-btn" id="autoDressBtn">
                        TRIGGER AUTO-DRESS RECOMMENDATION
                    </div>
                </div>
            </div>

            <!-- Temperature Monitoring Interface -->
            <div class="temperature-interface" id="temperatureInterface">
                <div class="prediction-header">
                    <div class="prediction-icon">
                        <i class="fas fa-thermometer-half"></i>
                    </div>
                    <h2 class="prediction-title" id="temperatureTitle">SPINDLE OVERHEATING</h2>
                </div>

                <div class="temp-grid">
                    <div class="temp-live">
                        <h3>LIVE TEMPERATURE</h3>
                        <div class="temp-value" id="liveTemp">68.5°C</div>
                        <div class="temp-status" id="tempStatus">NORMAL OPERATING RANGE</div>
                        <div class="temp-change" id="tempChange">+3.5°C LAST HOUR</div>
                    </div>

                    <div class="temp-chart">
                        <h3>TEMPERATURE TREND</h3>
                        <div class="temp-graph">
                            <div class="temp-threshold"></div>
                            <div class="temp-trend-line"></div>
                        </div>
                        <div class="temp-axis">
                            <span>1h</span>
                            <span>6</span>
                            <span>12</span>
                            <span>18</span>
                            <span>24 hr</span>
                        </div>
                    </div>
                </div>

                <div class="analysis-grid">
                    <div class="root-cause">
                        <h3>ROOT CAUSE ANALYSIS</h3>
                        <ul class="cause-list" id="rootCauseList">
                            <li>CHECK LUBRICATION</li>
                            <li>INSPECT SPINDLE FAN</li>
                            <li>REDUCE DEPTH OF CUT</li>
                        </ul>
                    </div>

                    <div class="shift-context">
                        <h3>SHIFT / OPERATOR CONTEXT</h3>
                        <div class="context-chart">
                            <div class="context-bars">
                                <div class="context-bar"></div>
                                <div class="context-bar"></div>
                                <div class="context-bar"></div>
                                <div class="context-bar"></div>
                                <div class="context-bar"></div>
                            </div>
                        </div>
                        <div class="context-labels">
                            <span>Shift 1</span>
                            <span>1</span>
                            <span>2</span>
                            <span>3</span>
                            <span>4</span>
                        </div>
                        <button class="export-btn">EXPORT LOGS...</button>
                    </div>
                </div>
            </div>

            <!-- Shift-Start Delay Interface -->
            <div class="shift-start-delay-interface" id="shiftStartDelayInterface">
                <div class="prediction-header">
                    <div class="prediction-icon">
                        <i class="fas fa-hourglass-half"></i>
                    </div>
                    <h2 class="prediction-title">SHIFT-START DELAY</h2>
                    <button class="export-btn">EXPORT</button>
                </div>

                <div class="delay-chart-section">
                    <h3>SHIFT-WISE DELAY HISTORY</h3>
                    <div class="chart-controls">
                        <select id="shiftDelayView" class="view-selector">
                            <option value="day">Day</option>
                            <option value="week">Week</option>
                            <option value="month">Month</option>
                        </select>
                        <div class="threshold-control">
                            <input type="number" id="delayThreshold" placeholder="Set threshold (min)" class="threshold-input">
                            <button class="threshold-btn" id="setDelayThresholdBtn">Set Threshold</button>
                        </div>
                    </div>
                    <div class="delay-chart-container">
                        <canvas id="shiftDelayChart"></canvas>
                    </div>
                </div>

                <div class="delay-analysis-grid">
                    <div class="operator-analysis">
                        <h3>OPERATOR-LEVEL ANALYSIS</h3>
                        <div class="operator-delays">
                            <div class="operator-delay-item">
                                <span class="operator-name">MARKUS</span>
                                <span class="delay-time">18 mins</span>
                            </div>
                            <div class="operator-delay-item">
                                <span class="operator-name">TOBIAS</span>
                                <span class="delay-time">7 mins</span>
                            </div>
                        </div>
                        <div class="alert-settings">
                            <h3>ALERT SETTINGS & THRESHOLDS</h3>
                            <div class="alert-options">
                                <div class="alert-option">
                                    <i class="fas fa-check"></i>
                                    <span>SMS to Supervisor</span>
                                </div>
                                <div class="alert-option">
                                    <i class="fas fa-check"></i>
                                    <span>Popup on Dashboard</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="contributing-factors">
                        <h3>CONTRIBUTING FACTORS LOG</h3>
                        <div class="factor-list">
                            <div class="factor-item checked">
                                <div class="checkbox"><i class="fas fa-check"></i></div>
                                <span>Machine not powered by maintenance</span>
                            </div>
                            <div class="factor-item">
                                <div class="checkbox"></div>
                                <span>No operator badge scan</span>
                            </div>
                            <div class="factor-item">
                                <div class="checkbox"></div>
                                <span>Coolant tank refill</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Historical Trend Interface -->
            <div class="historical-interface" id="historicalInterface">
                <div class="historical-header">
                    <h3 class="historical-title">HISTORICAL TREND</h3>
                    <div class="historical-controls">
                        <button class="view-toggle">VIEW BY OPERATOR</button>
                        <button class="export-btn">EXPORT PDF</button>
                    </div>
                </div>

                <div class="historical-chart">
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color changeover"></div>
                            <span>CHANGEOVER TIMES</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color idle"></div>
                            <span>MACHINE IDLE TIME</span>
                        </div>
                    </div>
                    <div class="chart-lines">
                        <div class="changeover-line"></div>
                        <div class="idle-line"></div>
                    </div>
                </div>

                <div class="bottom-grid">
                    <div class="operators-section">
                        <h4 class="section-title">OPERATORS</h4>
                        <div class="operator-item">
                                                       <span>Operator 3</span>
                            <span></span>
                        </div>
                        <div class="operator-item">
                            <span>Shift A</span>
                            <span>Avg. 2.7</span>
                        </div>
                        <div class="operator-item">
                            <span>Shift B</span>
                            <span>Avg. 3.9</span>
                        </div>
                        <div class="operator-item">
                            <span>Shift C</span>
                            <span>Avg. 4.4</span>
                        </div>
                    </div>

                    <div class="prediction-section">
                        <h4 class="section-title">PREDICTION</h4>
                        <div class="section-title" style="font-size: 0.9rem; margin-bottom: 0.5rem;">BASED ON PAST 15 RECORDS</div>
                        <div class="prediction-factor">
                            <div class="checkbox checked">✓</div>
                            <span>Operator ID</span>
                        </div>
                        <div class="prediction-factor">
                            <div class="checkbox"></div>
                            <span>Time of day</span>
                        </div>
                        <div class="prediction-factor">
                            <div class="checkbox"></div>
                            <span>Previous job complexity</span>
                        </div>
                    </div>

                    <div class="prediction-box">
                        <h4 class="section-title">PREDICTION</h4>
                        <div class="section-title" style="font-size: 0.9rem; margin-bottom: 0.5rem;">BASED ON PAST 15 RECORDS</div>
                        <div class="section-title" style="font-size: 0.9rem; margin-bottom: 1rem;">NEXT CHANGEOVER DELAY LIKELY</div>
                        <div class="prediction-value">4.2 min</div>
                        <div class="section-title" style="font-size: 0.9rem; margin-bottom: 0.5rem;">ROOT CAUSE & SUGGESTIONS</div>
                        <ul class="suggestions-list">
                            <li>
                                <div class="checkbox checked">✓</div>
                                <span>Delay in tool retrieval</span>
                            </li>
                            <li>
                                <div class="checkbox"></div>
                                <span>Incomplete part unload/load</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
                <!-- Add this inside the .insights-page, after the machine-cards div -->
        
        <div class="energy-cost-insight" style="background:#111;border:1px solid #333;border-radius:12px;padding:2rem;margin-top:2rem;color:#fff;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <h3 style="font-size:1.2rem;letter-spacing:1px;">ENERGY COST PER PART</h3>
                <button class="export-btn" style="background:#222;border:1px solid #555;border-radius:6px;color:#fff;padding:0.5rem 1rem;cursor:pointer;">
                    EXPORT PDF
                </button>
            </div>
            <div style="margin:1.5rem 0;">
                <div style="font-size:1rem;margin-bottom:0.5rem;">TREND (LAST 200 PARTS)</div>
                <div style="background:#000;border:2px dashed #444;border-radius:8px;height:120px;position:relative;overflow:hidden;margin-bottom:1rem;">
                    <!-- Simple SVG trend line (placeholder) -->
                    <svg width="100%" height="100%" viewBox="0 0 300 100" style="position:absolute;top:0;left:0;">
                        <polyline points="0,80 20,40 40,60 60,30 80,70 100,50 120,60 140,30 160,80 180,60 200,40 220,70 240,50 260,60 280,40 300,80"
                            style="fill:none;stroke:#fff;stroke-width:2"/>
                    </svg>
                </div>
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;">
                <div>
                    <div style="font-size:1rem;margin-bottom:0.5rem;">INFLUENCING FACTORS</div>
                    <div>Vibration Level <span style="color:#FFC107;">↑2% vs avg</span></div>
                    <div>Power Idle Time <span style="color:#FFC107;">↑ 18 mins today</span></div>
                    <hr style="border-top:1px solid #333;margin:1rem 0;">
                    <div style="font-size:1rem;margin-bottom:0.5rem;">COMPENSION</div>
                    <div style="margin-bottom:0.5rem;">
                        <svg width="60" height="20" style="vertical-align:middle;">
                            <polyline points="0,15 20,10 40,10 60,5" style="fill:none;stroke:#fff;stroke-width:2"/>
                        </svg>
                    </div>
                    <div style="font-size:0.95rem;color:#ccc;">
                        If current trend continues, energy cost per part may rise to ₹2.85 in next 3 days
                    </div>
                </div>
                <div>
                    <div style="font-size:1rem;margin-bottom:0.5rem;">COMPARISON</div>
                    <div>Shift A vs Shift B<br>Avg cost/part</div>
                    <div style="margin-top:0.5rem;">This week vs last week</div>
                    <hr style="border-top:1px solid #333;margin:1rem 0;">
                    <div style="font-size:1rem;margin-bottom:0.5rem;">COMPARISON</div>
                    <div>Shift A vs Shift B &nbsp; Avg cost/part</div>
                    <div>Part Type A vs B &nbsp; Energy deviation</div>
                </div>
            </div>
        </div>
        <!-- End energy cost insight -->
                 <!-- Shift-Start Delay Insight START -->
        <div class="shift-delay-insight" style="background:#111;border:1px solid #333;border-radius:12px;padding:2rem;margin-top:2rem;color:#fff;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <h3 style="font-size:1.2rem;letter-spacing:1px;">SHIFT-START DELAY</h3>
                <button class="export-btn" style="background:#222;border:1px solid #555;border-radius:6px;color:#fff;padding:0.5rem 1rem;cursor:pointer;">
                    EXPORT
                </button>
            </div>
            <div style="margin:1.5rem 0;">
                <div style="font-size:1rem;margin-bottom:0.5rem;">SHIFT-WISE DELAY HISTORY</div>
                <div style="display:flex;gap:1rem;align-items:center;">
                    <select id="shiftDelayView" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;">
                        <option value="day">Day</option>
                        <option value="week">Week</option>
                        <option value="month">Month</option>
                    </select>
                    <input type="number" id="delayThreshold" placeholder="Set threshold (min)" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;width:180px;">
                    <button class="export-btn" id="setThresholdBtn" style="margin-left:0.5rem;">Set Threshold</button>
                </div>
                <div style="background:#000;border:2px dashed #444;border-radius:8px;height:140px;position:relative;overflow:hidden;margin:1rem 0;">
                    <!-- SVG graph for 3 shifts, threshold line, colors match site scheme -->
                    <svg id="shiftDelayChart" width="100%" height="100%" viewBox="0 0 320 120" style="position:absolute;top:0;left:0;">
                        <!-- Example: Shift A (orange), Shift B (yellow), Shift C (gray) -->
                        <polyline id="shiftAline" points="10,80 50,60 90,70 130,50 170,60 210,40 250,60 290,50"
                            style="fill:none;stroke:#ff8c00;stroke-width:2"/>
                        <polyline id="shiftBline" points="10,90 50,70 90,80 130,60 170,70 210,50 250,70 290,60"
                            style="fill:none;stroke:#ffaa4d;stroke-width:2"/>
                        <polyline id="shiftCline" points="10,100 50,80 90,90 130,70 170,80 210,60 250,80 290,70"
                            style="fill:none;stroke:#888;stroke-width:2"/>
                        <!-- Threshold line (dotted) -->
                        <line id="thresholdLine" x1="0" y1="40" x2="320" y2="40" style="stroke:#FFC107;stroke-width:2;stroke-dasharray:6 4"/>
                        <!-- X-axis labels -->
                        <text x="10" y="115" font-size="10" fill="#fff">4/1</text>
                        <text x="90" y="115" font-size="10" fill="#fff">4/5</text>
                        <text x="170" y="115" font-size="10" fill="#fff">4/10</text>
                        <text x="250" y="115" font-size="10" fill="#fff">4/15</text>
                    </svg>
                    <div id="thresholdAlert" style="position:absolute;top:10px;right:10px;color:#FFC107;font-size:0.95rem;display:none;">
                        Alert: Delay crossed threshold!
                    </div>
                </div>
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;">
                <div>
                    <div style="font-size:1rem;margin-bottom:0.5rem;">OPERATOR-LEVEL ANALYSIS</div>
                    <form id="operatorDelayForm" style="margin-bottom:1rem;">
                        <div style="display:flex;gap:1rem;align-items:center;">
                            <input type="text" id="operator1" placeholder="Operator 1" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;">
                            <input type="number" id="operator1Delay" placeholder="Delay (min)" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;width:100px;">
                        </div>
                        <div style="display:flex;gap:1rem;align-items:center;margin-top:0.5rem;">
                            <input type="text" id="operator2" placeholder="Operator 2" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;">
                            <input type="number" id="operator2Delay" placeholder="Delay (min)" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;width:100px;">
                        </div>
                        <button type="submit" class="export-btn" style="margin-top:0.5rem;">Add</button>
                    </form>
                    <div id="operatorDelayResults" style="margin-bottom:1rem;">
                        <div style="display:flex;justify-content:space-between;">
                            <span id="op1Name">MARKUS</span>
                            <span id="op1Time">18 mins</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;">
                            <span id="op2Name">TOBIAS</span>
                            <span id="op2Time">7 mins</span>
                        </div>
                    </div>
                    <hr style="border-top:1px solid #333;margin:1rem 0;">
                    <div style="font-size:1rem;margin-bottom:0.5rem;">ALERT SETTINGS &amp; THRESHOLDS</div>
                    <div>
                        <span style="color:#FFC107;">&#10003;</span> SMS to Supervisor<br>
                        <span style="color:#FFC107;">&#10003;</span> Popup on Dashboard
                    </div>
                </div>
                <div>
                    <div style="font-size:1rem;margin-bottom:0.5rem;">CAUSES</div>
                    <div>
                        <span class="checkbox checked" style="margin-right:0.5rem;">&#10003;</span> Machine not powered by maintenance
                    </div>
                    <div>
                        <span class="checkbox" style="margin-right:0.5rem;"></span> No operator badge scan
                    </div>
                    <div>
                        <span class="checkbox" style="margin-right:0.5rem;"></span> Coolant tank refill
                    </div>
                    <div style="margin-top:1.5rem;">
                        <!-- Placeholder for status blocks -->
                        <div style="display:flex;gap:0.5rem;">
                            <div style="width:24px;height:24px;border:1px solid #fff;border-radius:4px;"></div>
                            <div style="width:24px;height:24px;border:1px solid #fff;border-radius:4px;"></div>
                            <div style="width:24px;height:24px;border:1px solid #fff;border-radius:4px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Shift-Start Delay Insight END -->
         <!-- Coolant Consumption Spike – Monitoring & Anomaly Detection START -->
<div class="coolant-monitor-section" style="background:#111;border:1px solid #333;border-radius:12px;padding:2rem;margin-top:2rem;color:#fff;">
    <h3 style="font-size:1.2rem;letter-spacing:1px;margin-bottom:1.5rem;">Coolant Consumption Spike – Monitoring & Anomaly Detection</h3>
    <div style="display:grid;grid-template-columns:1fr 2fr;gap:2rem;margin-bottom:2rem;">
        <!-- Live Coolant Usage -->
        <div style="background:#222;border:1px solid #444;border-radius:8px;padding:1.5rem;display:flex;flex-direction:column;align-items:center;justify-content:center;">
            <div style="font-size:2.5rem;font-weight:bold;margin-bottom:0.5rem;">6.2 <span style="font-size:1.2rem;">L/min</span></div>
            <div style="width:100%;height:24px;background:#000;border-radius:4px;position:relative;margin-bottom:0.5rem;">
                <div style="width:80%;height:100%;background:#ff8c00;border-radius:4px;"></div>
            </div>
            <div style="font-size:0.95rem;color:#ccc;">Daily usage above <span style="color:#FFC107;">line</span></div>
        </div>
        <!-- Coolant Trend Graph -->
        <div style="background:#222;border:1px solid #444;border-radius:8px;padding:1.5rem;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5rem;">
                <span style="font-size:1rem;">COOLANT TREND (LAST 48H)</span>
                <div>
                    <select id="coolantTrendView" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;">
                        <option value="day">Day</option>
                        <option value="week">Week</option>
                        <option value="month">Month</option>
                    </select>
                    <input type="number" id="coolantThreshold" placeholder="Set threshold (L/min)" style="background:#222;color:#fff;border:1px solid #555;border-radius:6px;padding:0.3rem 1rem;width:160px;margin-left:0.5rem;">
                    <button class="export-btn" id="setCoolantThresholdBtn" style="margin-left:0.5rem;">Set Threshold</button>
                </div>
            </div>
            <div style="background:#000;border:2px dashed #444;border-radius:8px;height:120px;position:relative;overflow:hidden;">
                <!-- SVG graph for coolant trend, threshold line -->
                <svg id="coolantTrendChart" width="100%" height="100%" viewBox="0 0 300 100" style="position:absolute;top:0;left:0;">
                    <!-- Example trend line (replace with real data in JS) -->
                    <polyline id="coolantTrendLineDay" points="0,80 20,70 40,75 60,60 80,65 100,55 120,70 140,80 160,85 180,90 200,95 220,85 240,80 260,90 280,95 300,90"
                        style="fill:none;stroke:#ff8c00;stroke-width:2;display:block;"/>
                    <polyline id="coolantTrendLineWeek" points="0,90 30,80 60,85 90,70 120,75 150,65 180,80 210,90 240,95 270,85 300,90"
                        style="fill:none;stroke:#ffaa4d;stroke-width:2;display:none;"/>
                    <polyline id="coolantTrendLineMonth" points="0,95 60,90 120,85 180,80 240,75 300,70"
                        style="fill:none;stroke:#888;stroke-width:2;display:none;"/>
                    <!-- Threshold line (dotted, JS will update y) -->
                    <line id="coolantThresholdLine" x1="0" y1="40" x2="300" y2="40" style="stroke:#FFC107;stroke-width:2;stroke-dasharray:6 4"/>
                    <!-- X-axis labels -->
                    <text x="0" y="110" font-size="10" fill="#fff">00h</text>
                    <text x="60" y="110" font-size="10" fill="#fff">12h</text>
                    <text x="120" y="110" font-size="10" fill="#fff">24h</text>
                    <text x="180" y="110" font-size="10" fill="#fff">36h</text>
                    <text x="240" y="110" font-size="10" fill="#fff">48h</text>
                </svg>
                <div id="coolantThresholdAlert" style="position:absolute;top:10px;right:10px;color:#FFC107;font-size:0.95rem;display:none;">
                    Alert: Coolant flow crossed threshold!
                </div>
            </div>
            <div style="font-size:0.95rem;color:#ccc;text-align:right;margin-top:0.5rem;">TODAY</div>
        </div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;">
        <!-- Alert Log -->
        <div>
            <div style="font-size:1rem;margin-bottom:0.5rem;">ALERT LOG</div>
            <div style="margin-bottom:0.5rem;">
                <span style="color:#FFC107;"><i class="fas fa-exclamation-circle"></i></span>
                Flow abuse: threshold<br>
                <span style="font-size:0.9rem;color:#ccc;">2:12 PM &nbsp; Today</span>
            </div>
            <div style="margin-bottom:0.5rem;">
                <span style="color:#ffaa4d;"><i class="fas fa-exclamation-triangle"></i></span>
                Possible Leak: Flow stabilized after filter repair
            </div>
            <div style="font-size:1rem;margin-bottom:0.5rem;">Possible Causes:</div>
            <ul style="color:#fff;font-size:0.95rem;margin-bottom:1rem;">
                <li>Loose coolant pipe/fitting</li>
                <li>Valve left open after</li>
                <li>Dirty filter or pressure drop</li>
                <li>Faulty solenoid</li>
            </ul>
        </div>
        <!-- Anomaly Detection -->
        <div>
            <div style="font-size:1rem;margin-bottom:0.5rem;">ANOMALY DETECTION</div>
            <div style="margin-bottom:0.5rem;">AI DETECTED SPIKES</div>
            <div style="background:#222;border:1px solid #444;border-radius:6px;padding:0.75rem 1rem;margin-bottom:1rem;">
                <div>Detected Pattern: <span style="color:#FFC107;">Flow ↑ 588%</span></div>
                <div>Flow within 15 min of each shift change</div>
            </div>
            <button class="export-btn" id="setCoolantAlertThresholdBtn" style="margin-bottom:1rem;">SET ALERT THRESHOLD</button>
            <div style="display:flex;gap:1rem;">
                <div style="background:#222;border:1px solid #444;border-radius:6px;padding:0.5rem 1rem;">
                    <div style="font-size:0.95rem;color:#ccc;">COOLANT TEMPERATURE</div>
                    <div style="font-size:1.2rem;font-weight:bold;">35°C</div>
                </div>
                <div style="background:#222;border:1px solid #444;border-radius:6px;padding:0.5rem 1rem;">
                    <div style="font-size:0.95rem;color:#ccc;">CONDUCTIVITY</div>
                    <div style="font-size:1rem;color:#4CAF50;">WITHIN RANGE</div>
                </div>
                <div style="background:#222;border:1px solid #444;border-radius:6px;padding:0.5rem 1rem;">
                    <div style="font-size:0.95rem;color:#ccc;">CONTAMINATION RISK</div>
                    <div style="font-size:1rem;color:#FFC107;">LOW</div>
                </div>
            </div>
            <button class="export-btn" style="margin-top:1rem;">TRIGGER MAINTENANCE TICKET</button>
        </div>
    </div>
</div>
<!-- Coolant Consumption Spike – Monitoring & Anomaly Detection END -->

    </div>

    <!-- Machine Details View -->
    <div class="machine-details-view" id="machineDetailsView" style="display: none;">
        <div class="container">
            <div class="view-header">
                <button class="back-btn" id="backToType">
                    <i class="fas fa-arrow-left"></i> <span data-translate="back_to_machines">Back to Machines</span>
                </button>
                <button class="btn btn-primary" id="addDataEntryBtn">
                    <i class="fas fa-plus"></i> <span data-translate="add_data_entry">Add Data Entry</span>
                </button>
            </div>
            
            <div class="machine-info-card">
                <h1 id="machineDetailsName">Machine Name</h1>
                <div class="machine-meta">
                    <span class="machine-type-badge" id="machineDetailsBadge">Milling</span>
                    <span class="machine-date" id="machineDetailsDate" data-translate="added_today">Added today</span>
                </div>
                
                <div class="machine-stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-calendar"></i>
                        <div class="stat-value" id="machineDataEntries">0</div>
                        <div class="stat-label" data-translate="data_entries">Data Entries</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-clock"></i>
                        <div class="stat-value" id="machineTotalHours">0h</div>
                        <div class="stat-label" data-translate="total_hours">Total Hours</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-box"></i>
                        <div class="stat-value" id="machineTotalProducts">0</div>
                        <div class="stat-label" data-translate="total_products">Total Products</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-chart-line"></i>
                        <div class="stat-value" id="machineEfficiency">0</div>
                        <div class="stat-label" data-translate="products_per_hour">Products/Hour</div>
                    </div>
                </div>
            </div>

            <div class="view-tabs">
                <button class="tab-btn active" data-tab="overview"><span data-translate="overview">Overview</span></button>
                <button class="tab-btn" data-tab="operators"><span data-translate="operators">Operators</span></button>
                <button class="tab-btn" data-tab="analytics"><span data-translate="analytics">Analytics</span></button>
            </div>

            <div class="tab-content">
                <div class="tab-pane active" id="overviewTab">
                    <div class="data-entries-table">
                        <h2 data-translate="recent_data_entries">Recent Data Entries</h2>
                        <div class="table-container">
                            <table id="dataEntriesTable">
                                <thead>
                                    <tr>
                                        <th data-translate="date">Date</th>
                                        <th data-translate="operator">Operator</th>
                                        <th data-translate="working_hours">Working Hours</th>
                                        <th data-translate="products_made">Products Made</th>
                                        <th data-translate="efficiency">Efficiency</th>
                                        <th data-translate="notes">Notes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Data entries will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div class="tab-pane" id="operatorsTab">
                    <div class="operators-list" id="operatorsList">
                        <!-- Operators will be populated here -->
                    </div>
                </div>
                
                <div class="tab-pane" id="analyticsTab">
                    <div class="analytics-container">
                        <div class="chart-controls">
                            <button class="chart-btn active" data-chart="products"><span data-translate="products">Products</span></button>
                            <button class="chart-btn" data-chart="hours"><span data-translate="hours">Hours</span></button>
                            <button class="chart-btn" data-chart="efficiency"><span data-translate="efficiency">Efficiency</span></button>
                        </div>
                        <div class="chart-container">
                            <canvas id="machineChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Operators View -->
    <div class="operators-view" id="operatorsView" style="display: none;">
        <div class="container">
            <div class="view-header">
                <button class="back-btn" id="backToMainFromOperators">
                    <i class="fas fa-arrow-left"></i> <span data-translate="back_to_dashboard">Back to Dashboard</span>
                </button>
                <div class="view-title">
                    <h1 data-translate="operators">Operators</h1>
                    <p data-translate="operators_subtitle">View operator performance and statistics</p>
                </div>
            </div>

            <div class="operators-grid" id="operatorsGrid">
                <!-- Operators will be populated here -->
            </div>
        </div>
    </div>

    <!-- Analytics Page -->
    <div class="analytics-page" id="analyticsPage" style="display: none;">
        <div class="container">
            <div class="view-header">
                <button class="back-btn" id="backToMainFromAnalytics">
                    <i class="fas fa-arrow-left"></i> <span data-translate="back_to_dashboard">Back to Dashboard</span>
                </button>
                <div class="view-title">
                    <h1 data-translate="analytics_dashboard">Analytics Dashboard</h1>
                    <p data-translate="analytics_subtitle">Comprehensive insights into your machine performance</p>
                </div>
                <div class="time-range-selector">
                    <button class="time-btn active" data-range="7d"><span data-translate="7_days">7 Days</span></button>
                    <button class="time-btn" data-range="30d"><span data-translate="30_days">30 Days</span></button>
                    <button class="time-btn" data-range="90d"><span data-translate="90_days">90 Days</span></button>
                    <button class="time-btn" data-range="all"><span data-translate="all_time">All Time</span></button>
                </div>
            </div>

            <div class="analytics-stats-grid">
                <div class="analytics-stat-card">
                    <i class="fas fa-industry"></i>
                    <div class="stat-value" id="analyticsTotalMachines">0</div>
                    <div class="stat-label" data-translate="total_machines">Total Machines</div>
                </div>
                <div class="analytics-stat-card">
                    <i class="fas fa-play-circle"></i>
                    <div class="stat-value" id="analyticsActiveMachines">0</div>
                    <div class="stat-label" data-translate="active_machines">Active Machines</div>
                </div>
                <div class="analytics-stat-card">
                    <i class="fas fa-box"></i>
                    <div class="stat-value" id="analyticsTotalProducts">0</div>
                    <div class="stat-label" data-translate="total_products">Total Products</div>
                </div>
                <div class="analytics-stat-card">
                    <i class="fas fa-clock"></i>
                    <div class="stat-value" id="analyticsTotalHours">0h</div>
                    <div class="stat-label" data-translate="total_hours">Total Hours</div>
                </div>
                <div class="analytics-stat-card">
                    <i class="fas fa-chart-line"></i>
                    <div class="stat-value" id="analyticsAvgEfficiency">0</div>
                    <div class="stat-label" data-translate="avg_efficiency">Avg Efficiency</div>
                </div>
                <div class="analytics-stat-card">
                    <i class="fas fa-calendar-alt"></i>
                    <div class="stat-value" id="analyticsTotalEntries">0</div>
                    <div class="stat-label" data-translate="data_entries">Data Entries</div>
                </div>
            </div>

            <div class="analytics-charts-grid">
                <div class="chart-card">
                    <h3 data-translate="performance_over_time">Performance Over Time</h3>
                    <div class="chart-metric-selector">
                        <button class="metric-btn active" data-metric="products"><span data-translate="products">Products</span></button>
                        <button class="metric-btn" data-metric="hours"><span data-translate="hours">Hours</span></button>
                        <button class="metric-btn" data-metric="efficiency"><span data-translate="efficiency">Efficiency</span></button>
                    </div>
                    <canvas id="timeSeriesChart"></canvas>
                </div>
                
                <div class="chart-card">
                    <h3 data-translate="performance_by_type">Performance by Machine Type</h3>
                    <canvas id="machineTypeChart"></canvas>
                </div>
            </div>

            <div class="top-machines-table">
                <h3 data-translate="top_performing_machines">Top Performing Machines</h3>
                <div class="table-container">
                    <table id="topMachinesTable">
                        <thead>
                            <tr>
                                <th data-translate="machine_name">Machine Name</th>
                                <th data-translate="type">Type</th>
                                <th data-translate="products">Products</th>
                                <th data-translate="hours">Hours</th>
                                <th data-translate="efficiency">Efficiency</th>
                                <th data-translate="entries">Entries</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Top machines will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Machine Modal -->
    <div class="modal" id="addMachineModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-translate="add_new_machine">Add New Machine</h2>
                <button class="close-btn" data-modal="addMachineModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addMachineForm">
                <div class="form-group">
                    <label for="machineName" data-translate="machine_name">Machine Name</label>
                    <input type="text" id="machineName" name="machineName" required>
                    <div class="error-message" id="machineNameError"></div>
                </div>
                <div class="form-group">
                    <label for="machineType" data-translate="machine_type">Machine Type</label>
                    <select id="machineType" name="machineType" required>
                        <option value="" data-translate="select_machine_type">Select machine type</option>
                        <option value="Milling" data-translate="milling">Milling</option>
                        <option value="Grinding" data-translate="grinding">Grinding</option>
                        <option value="Cutting" data-translate="cutting">Cutting</option>
                    </select>
                    <div class="error-message" id="machineTypeError"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-modal="addMachineModal" data-translate="cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary" data-translate="add_machine">Add Machine</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Line Modal -->
    <div class="modal" id="addLineModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 data-translate="add_line_of_machines">Add Line of Machines</h2>
                <button class="close-btn" data-modal="addLineModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addLineForm">
                <div id="machineSlots">
                    <!-- Machine slots will be generated here -->
                </div>
                <button type="button" class="btn btn-outline" id="addMachineSlot">
                    <i class="fas fa-plus"></i> <span data-translate="add_another_machine">Add Another Machine</span>
                </button>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-modal="addLineModal" data-translate="cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary" data-translate="add_all_machines">Add All Machines</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Data Entry Modal -->
    <div class="modal" id="addDataEntryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-translate="add_data_entry">Add Data Entry</h2>
                <button class="close-btn" data-modal="addDataEntryModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addDataEntryForm">
                <div class="form-group">
                    <label for="entryDate" data-translate="date">Date</label>
                    <input type="date" id="entryDate" name="entryDate" required>
                    <div class="error-message" id="entryDateError"></div>
                </div>
                <div class="form-group">
                    <label for="operatorName" data-translate="operator_name">Operator Name</label>
                    <input type="text" id="operatorName" name="operatorName" required>
                    <div class="error-message" id="operatorNameError"></div>
                </div>
                <div class="form-group">
                    <label for="workingHours" data-translate="working_hours">Working Hours</label>
                    <input type="number" id="workingHours" name="workingHours" step="0.1" min="0" max="24" required>
                    <div class="error-message" id="workingHoursError"></div>
                </div>
                <div class="form-group">
                    <label for="productsManufactured" data-translate="products_manufactured">Products Manufactured</label>
                    <input type="number" id="productsManufactured" name="productsManufactured" min="0" required>
                    <div class="error-message" id="productsManufacturedError"></div>
                </div>
                <div class="form-group">
                    <label for="notes" data-translate="notes_optional">Notes (Optional)</label>
                    <textarea id="notes" name="notes" rows="3" placeholder="Add any notes about this entry..." data-translate="notes_placeholder"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-modal="addDataEntryModal" data-translate="cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary" data-translate="add_entry">Add Entry</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Operator Details Modal -->
    <div class="modal" id="operatorDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="operatorDetailsTitle" data-translate="operator_details">Operator Details</h2>
                <button class="close-btn" data-modal="operatorDetailsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="operatorDetailsContent">
                <!-- Operator details will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Application State
        let currentUser = null;
        let machines = [];
        let dataEntries = [];
        let operators = {};
        let currentView = 'login';
        let currentMachine = null;
        let currentMachineType = null;
        let currentOperator = null;
        let isDarkTheme = true;
        let currentLanguage = 'en';

        // Chart instances
        let machineChart = null;
        let timeSeriesChart = null;
        let machineTypeChart = null;
        let operatorChart = null;

        // Language translations
        const translations = {
            en: {
                vericore: "VERICORE",
                system_description: "Industrial Machine Management System",
                login_with_google: "Login with Google",
                profile: "Profile",
                change_plan: "Change Plan",
                change_language: "Change Language",
                settings: "Settings",
                logout: "Logout",
                dashboard_title: "Machine Management Dashboard",
                dashboard_subtitle: "Monitor and manage your industrial equipment",
                add_machine: "Add Machine",
                add_line: "Add Line of Machines",
                insights: "Insights",
                insights_subtitle: "Machine type overview and analysis",
                analyse: "Analyse",
                view_operators: "View Operators",
                machines: "machines",
                milling: "Milling",
                milling_description: "Precision milling machines",
                grinding: "Grinding",
                grinding_description: "Industrial grinding equipment",
                cutting: "Cutting",
                cutting_description: "Advanced cutting systems",
                view_details: "View Details",
                quick_stats: "Quick Statistics",
                total_machines: "Total Machines",
                active_machines: "Active Machines",
                data_entries: "Data Entries",
                products_made: "Products Made",
                back_to_dashboard: "Back to Dashboard",
                milling_machines: "Milling Machines",
                machines_in_category: "machines in this category",
                back_to_machines: "Back to Machines",
                add_data_entry: "Add Data Entry",
                added_today: "Added today",
                total_hours: "Total Hours",
                total_products: "Total Products",
                products_per_hour: "Products/Hour",
                overview: "Overview",
                operators: "Operators",
                analytics: "Analytics",
                recent_data_entries: "Recent Data Entries",
                date: "Date",
                operator: "Operator",
                working_hours: "Working Hours",
                products_made: "Products Made",
                efficiency: "Efficiency",
                notes: "Notes",
                products: "Products",
                hours: "Hours",
                operators_subtitle: "View operator performance and statistics",
                analytics_dashboard: "Analytics Dashboard",
                analytics_subtitle: "Comprehensive insights into your machine performance",
                "7_days": "7 Days",
                "30_days": "30 Days",
                "90_days": "90 Days",
                all_time: "All Time",
                avg_efficiency: "Avg Efficiency",
                performance_over_time: "Performance Over Time",
                performance_by_type: "Performance by Machine Type",
                top_performing_machines: "Top Performing Machines",
                machine_name: "Machine Name",
                type: "Type",
                entries: "Entries",
                add_new_machine: "Add New Machine",
                machine_type: "Machine Type",
                select_machine_type: "Select machine type",
                cancel: "Cancel",
                add_line_of_machines: "Add Line of Machines",
                add_another_machine: "Add Another Machine",
                add_all_machines: "Add All Machines",
                operator_name: "Operator Name",
                products_manufactured: "Products Manufactured",
                notes_optional: "Notes (Optional)",
                notes_placeholder: "Add any notes about this entry...",
                add_entry: "Add Entry",
                operator_details: "Operator Details",
                operator_levels: {
                    trainee: "Trainee Operator",
                    skilled: "Skilled Handler",
                    precision: "Precision Pro",
                    veteran: "Floor Veteran",
                    whisperer: "Machine Whisperer",
                    master: "Master of Motion",
                    champion: "Efficiency Champion",
                    legendary: "Legendary Operator"
                }
            },
            hi: {
                vericore: "वेरिकोर",
                system_description: "औद्योगिक मशीन प्रबंधन प्रणाली",
                login_with_google: "Google के साथ लॉगिन करें",
                profile: "प्रोफ़ाइल",
                change_plan: "योजना बदलें",
                change_language: "भाषा बदलें",
                settings: "सेटिंग्स",
                logout: "लॉग आउट",
                dashboard_title: "मशीन प्रबंधन डैशबोर्ड",
                dashboard_subtitle: "अपने औद्योगिक उपकरणों की निगरानी और प्रबंधन करें",
                add_machine: "मशीन जोड़ें",
                add_line: "मशीनों की लाइन जोड़ें",
                analyse: "विश्लेषण",
                view_operators: "ऑपरेटर देखें",
                machines: "मशीनें",
                milling: "मिलिंग",
                milling_description: "सटीक मिलिंग मशीनें",
                grinding: "ग्राइंडिंग",
                grinding_description: "औद्योगिक ग्राइंडिंग उपकरण",
                cutting: "कटिंग",
                cutting_description: "उन्नत कटिंग सिस्टम",
                view_details: "विवरण देखें",
                quick_stats: "त्वरित आँकड़े",
                total_machines: "कुल मशीनें",
                active_machines: "सक्रिय मशीनें",
                data_entries: "डेटा प्रविष्टियाँ",
                products_made: "बनाए गए उत्पाद",
                back_to_dashboard: "डैशबोर्ड पर वापस जाएं",
                milling_machines: "मिलिंग मशीनें",
                machines_in_category: "इस श्रेणी में मशीनें",
                back_to_machines: "मशीनों पर वापस जाएं",
                add_data_entry: "डेटा प्रविष्टि जोड़ें",
                added_today: "आज जोड़ा गया",
                total_hours: "कुल घंटे",
                total_products: "कुल उत्पाद",
                products_per_hour: "उत्पाद/घंटा",
                overview: "अवलोकन",
                operators: "ऑपरेटर",
                analytics: "विश्लेषण",
                recent_data_entries: "हालिया डेटा प्रविष्टियाँ",
                date: "तारीख",
                operator: "ऑपरेटर",
                working_hours: "कार्य घंटे",
                products_made: "बनाए गए उत्पाद",
                efficiency: "दक्षता",
                notes: "नोट्स",
                products: "उत्पाद",
                hours: "घंटे",
                operators_subtitle: "ऑपरेटर प्रदर्शन और आँकड़े देखें",
                analytics_dashboard: "विश्लेषण डैशबोर्ड",
                analytics_subtitle: "आपके मशीन प्रदर्शन की व्यापक जानकारी",
                "7_days": "7 दिन",
                "30_days": "30 दिन",
                "90_days": "90 दिन",
                all_time: "सभी समय",
                avg_efficiency: "औसत दक्षता",
                performance_over_time: "समय के साथ प्रदर्शन",
                performance_by_type: "मशीन प्रकार द्वारा प्रदर्शन",
                top_performing_machines: "शीर्ष प्रदर्शन करने वाली मशीनें",
                machine_name: "मशीन का नाम",
                type: "प्रकार",
                entries: "प्रविष्टियाँ",
                add_new_machine: "नई मशीन जोड़ें",
                machine_type: "मशीन प्रकार",
                select_machine_type: "मशीन प्रकार चुनें",
                cancel: "रद्द करें",
                add_line_of_machines: "मशीनों की लाइन जोड़ें",
                add_another_machine: "एक और मशीन जोड़ें",
                add_all_machines: "सभी मशीनें जोड़ें",
                operator_name: "ऑपरेटर का नाम",
                products_manufactured: "निर्मित उत्पाद",
                notes_optional: "नोट्स (वैकल्पिक)",
                notes_placeholder: "इस प्रविष्टि के बारे में कोई नोट्स जोड़ें...",
                add_entry: "प्रविष्टि जोड़ें",
                operator_details: "ऑपरेटर विवरण",
                operator_levels: {
                    trainee: "प्रशिक्षु ऑपरेटर",
                    skilled: "कुशल हैंडलर",
                    precision: "सटीक पेशेवर",
                    veteran: "अनुभवी फ्लोर ऑपरेटर",
                    whisperer: "मशीन व्हिस्परर",
                    master: "मोशन मास्टर",
                    champion: "दक्षता चैंपियन",
                    legendary: "पौराणिक ऑपरेटर"
                }
            }
            // Other languages would follow the same pattern with translations for operator levels
        };

        // Stats Page Functions
        function showStatsPage() {
            hideAllViews();
            document.getElementById('statsPage').style.display = 'block';
            
            // Initialize stats cards if not already done
            const statsGrid = document.querySelector('.stats-grid');
            if (statsGrid && !statsGrid.children.length) {
                initializeStatsCards();
            }
        }

        function initializeStatsCards() {
            const statsGrid = document.querySelector('.stats-grid');
            if (!statsGrid) return;

            const statsData = [
                { title: 'Overall Equipment', value: '85%', subStats: [
                    { label: 'Availability', value: '88%' },
                    { label: 'Performance', value: '82%' },
                    { label: 'Quality', value: '94%' }
                ]},
                { title: 'Spindle Overheating Prediction', value: '23% SENSED', icon: 'exclamation-triangle' },
                { title: 'Chatter & Vibration Alert', value: '18 hours', description: 'until wheel replacing', subValue: '₹ 450/day' },
                { title: 'Grinding Wheel Dullness', value: '18 hr', description: 'Estimates to wheel replac' },
                { title: 'Coolant Consumption Spike', value: '→14% today' },
                { title: 'Coolant Cost Impact', value: '₹ 3,7 k/month' },
                { title: 'Idle Power Loss Tracking', value: '₹ 3,7 k/month' },
                { title: 'Chatter & Vibration Alerts', value: '4 occurrences', description: 'this week', subValue: '₹ 450/day' },
                { title: 'Delayed Shift Start Report', value: '4', description: 'shifts delayed per week' },
                { title: 'Labor Hours Lost to Delay', value: '5:30', description: 'this week' },
                { title: 'Energy Cost Per Machine', value: '₹ 450/day', chartId: 'energyCostChart' },
                { title: 'Delayed Shift Start Report', value: '4', description: 'shifts delayed per week', chartId: 'shiftDelayChart' },
                { title: 'Part Changeover Delay Mapping', chartId: 'changeoverDelayChart' },
                { title: 'Per-Part Energy Cost', chartId: 'perPartEnergyChart' },
                { title: 'Grinding Cycle Variation', chartId: 'grindingCycleChart' },
                { title: 'Alert Summary', description: 'by Financial Risk', value: '8 red • 27 yellow', subValue: '15 yellow' },
                { title: 'ROI of Vericore System', value: '3.1x' },
                { title: 'SAVED VIA PREVENTIVE ACTIONS', value: '₹ 45,200', description: 'this month' }
            ];

            statsData.forEach((data, index) => {
                const card = document.createElement('div');
                card.className = 'stat-card';
                card.setAttribute('data-enum', index + 1);

                let content = `<div class="card-content">
                    <div class="title">${data.title}</div>`;

                if (data.value) {
                    content += `<div class="value">${data.value}</div>`;
                }

                if (data.description) {
                    content += `<div class="description">${data.description}</div>`;
                }

                if (data.subValue) {
                    content += `<div class="highlight">${data.subValue}</div>`;
                }

                if (data.subStats) {
                    content += `<div class="mini-stats">`;
                    data.subStats.forEach(stat => {
                        content += `<div class="mini-stat">
                            <div class="mini-stat-label">${stat.label}</div>
                            <div class="mini-stat-value">${stat.value}</div>
                        </div>`;
                    });
                    content += `</div>`;
                }

                if (data.chartId) {
                    content += `<canvas id="${data.chartId}"></canvas>
                        <div class="chart-label">Jan Feb Mar Apr May Jun Jul</div>`;
                }

                content += `</div>`;
                card.innerHTML = content;
                statsGrid.appendChild(card);

                // Initialize chart if needed
                if (data.chartId) {
                    initializeChart(data.chartId);
                }
            });
        }

        function initializeChart(chartId) {
            const ctx = document.getElementById(chartId).getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                    datasets: [{
                        data: generateRandomData(7),
                        borderColor: '#FFC107',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { display: false },
                        y: { display: false }
                    }
                }
            });
        }

        function generateRandomData(count) {
            return Array.from({ length: count }, () => Math.floor(Math.random() * 50) + 50);
        }

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            
            // Initialize charts if they exist
            if (document.getElementById('coolantTrendChart')) {
                renderStatsCharts();
            }
            
            // Set up initial view
            showMainContent();
        });

        // Initialize Shift Delay Chart
        function initializeShiftDelayChart() {
            const ctx = document.getElementById('shiftDelayChart').getContext('2d');
            const shiftDelayData = {
                labels: ['4/1', '4/1', '4/1', '4/1', '4/5', '4/1', '4/10', '4/10'],
                datasets: [
                    {
                        label: 'Delay Time',
                        data: [32, 28, 31, 29, 27, 24, 21, 20],
                        backgroundColor: '#ff8c00',
                        borderColor: '#ff8c00',
                        borderWidth: 2,
                    },
                    {
                        label: 'Trend Line',
                        data: [15, 18, 22, 20, 19, 17, 15, 8],
                        backgroundColor: 'rgba(255, 193, 7, 0.2)',
                        borderColor: '#FFC107',
                        borderWidth: 2,
                        borderDash: [5, 5],
                    }
                ]
            };

            const shiftDelayChart = new Chart(ctx, {
                type: 'bar',
                data: shiftDelayData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#333'
                            },
                            ticks: {
                                color: '#999'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#999'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            return shiftDelayChart;
        }

        function updateDelayChart(view) {
            const data = {
                day: [32, 28, 31, 29, 27, 24, 21, 20],
                week: [30, 25, 28, 26, 24, 22, 20, 18],
                month: [25, 23, 24, 22, 21, 20, 19, 18]
            };

            const chart = Chart.getChart('shiftDelayChart');
            if (chart) {
                chart.data.datasets[0].data = data[view];
                chart.update();
            }
        }

        function initializeApp() {
            try {
                // Initialize application state
                machines = [];
                dataEntries = [];
                operators = {};
                
                // Load saved theme
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme) {
                    isDarkTheme = savedTheme === 'dark';
                    updateTheme();
                }
                
                // Load saved language
                const savedLanguage = localStorage.getItem('language');
                if (savedLanguage && translations[savedLanguage]) {
                    currentLanguage = savedLanguage;
                }
                
                // Initialize Shift Delay Chart if element exists
                if (document.getElementById('shiftDelayChart')) {
                    initializeShiftDelayChart();
                }

                // Set up shift delay interface handlers
                const shiftDelayView = document.getElementById('shiftDelayView');
                if (shiftDelayView) {
                    shiftDelayView.addEventListener('change', (e) => {
                        updateDelayChart(e.target.value);
                    });
                }

                const setDelayThresholdBtn = document.getElementById('setDelayThresholdBtn');
                if (setDelayThresholdBtn) {
                    setDelayThresholdBtn.addEventListener('click', () => {
                        const threshold = document.getElementById('delayThreshold').value;
                        if (threshold) {
                            const chart = Chart.getChart('shiftDelayChart');
                            if (chart) {
                                // Add threshold line to chart
                                chart.options.plugins.annotation = {
                                    annotations: {
                                        thresholdLine: {
                                            type: 'line',
                                            yMin: threshold,
                                            yMax: threshold,
                                            borderColor: '#FFC107',
                                            borderWidth: 2,
                                            borderDash: [5, 5]
                                        }
                                    }
                                };
                                chart.update();
                            }
                        }
                    });
                }

                // Load saved data before checking user state
                loadDataFromStorage();
                
                // Check for saved user
                const savedUser = localStorage.getItem('currentUser');
                if (savedUser) {
                    try {
                        currentUser = JSON.parse(savedUser);
                        showMainContent();
                    } catch (error) {
                        console.error('Error parsing saved user:', error);
                        localStorage.removeItem('currentUser');
                        showLoginPage();
                    }
                } else {
                    showLoginPage();
                }
                
                // Apply translations
                updateTranslations();
                
                // Initialize charts if on stats page
                if (document.getElementById('statsPage') && 
                    document.getElementById('statsPage').style.display !== 'none') {
                    renderStatsCharts();
                }
                
                showNotification('Application initialized successfully', 'success');
                
            } catch (error) {
                console.error('Error initializing application:', error);
                showNotification('Error initializing application. Please refresh the page.', 'error');
            }
        }

        function setupEventListeners() {
        
            
            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // Profile dropdown
            document.getElementById('profileBtn').addEventListener('click', toggleProfileDropdown);
            document.getElementById('logoutBtn').addEventListener('click', logout);
            
            // Language dropdown
            document.getElementById('languageBtn').addEventListener('click', toggleLanguageDropdown);
            document.querySelectorAll('#languageDropdown a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    changeLanguage(e.target.closest('[data-lang]').dataset.lang);
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.profile-section')) {
                    hideProfileDropdown();
                    hideLanguageDropdown();
                }
            });
            
            // Login
            document.getElementById('googleLoginBtn').addEventListener('click', handleGoogleLogin);
            
            // Navigation
            document.getElementById('addMachineBtn').addEventListener('click', () => showModal('addMachineModal'));
            document.getElementById('addLineBtn').addEventListener('click', () => {
                initializeLineModal();
                showModal('addLineModal');
            });
            document.getElementById('insightsBtn').addEventListener('click', showInsightsPage);
                document.getElementById('analyseBtn').addEventListener('click', showAnalyticsPage);
                document.getElementById('viewOperatorsBtn').addEventListener('click', showOperatorsView);
                document.getElementById('statsBtn').addEventListener('click', showStatsPage);            // Back buttons
            document.getElementById('backToMain').addEventListener('click', showMainContent);
            document.getElementById('backToType').addEventListener('click', () => showMachineTypeView(currentMachineType));
            document.getElementById('backToMainFromOperators').addEventListener('click', showMainContent);
            document.getElementById('backToMainFromAnalytics').addEventListener('click', showMainContent);
            document.getElementById('backToMainFromInsights').addEventListener('click', showMainContent);
            
            // Machine type cards
            document.querySelectorAll('.machine-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    const type = e.currentTarget.dataset.type;
                    showMachineTypeView(type);
                });
            });
            
            // Modal close buttons
            document.querySelectorAll('.close-btn, [data-modal]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const modalId = e.target.dataset.modal || e.target.closest('[data-modal]')?.dataset.modal;
                    if (modalId) {
                        hideModal(modalId);
                    }
                });
            });
            
            // Forms
            document.getElementById('addMachineForm').addEventListener('submit', handleAddMachine);
            document.getElementById('addLineForm').addEventListener('submit', handleAddLine);
            document.getElementById('addDataEntryForm').addEventListener('submit', handleAddDataEntry);
            
            // Add machine slot button
            document.getElementById('addMachineSlot').addEventListener('click', addMachineSlot);
            
            // Data entry button
            document.getElementById('addDataEntryBtn').addEventListener('click', () => {
                initializeDataEntryModal();
                showModal('addDataEntryModal');
            });
            
            // Tab switching
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('tab-btn')) {
                    switchTab(e.target.dataset.tab);
                }
            });
            
            // Chart controls
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('chart-btn')) {
                    switchChart(e.target.dataset.chart);
                }
                if (e.target.classList.contains('metric-btn')) {
                    switchMetric(e.target.dataset.metric);
                }
                if (e.target.classList.contains('time-btn')) {
                    switchTimeRange(e.target.dataset.range);
                }
            });
            
            // Close modals when clicking outside
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    hideAllModals();
                }
            });
        }

        // Language Management
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('languageDropdown');
            dropdown.classList.toggle('show');
        }

        function hideLanguageDropdown() {
            document.getElementById('languageDropdown').classList.remove('show');
        }

        function changeLanguage(lang) {
            if (translations[lang]) {
                currentLanguage = lang;
                localStorage.setItem('language', lang);
                updateTranslations();
                hideLanguageDropdown();
                
                // Update the active language indicator
                document.querySelectorAll('#languageDropdown a').forEach(link => {
                    const icon = link.querySelector('i');
                    if (link.dataset.lang === lang) {
                        icon.className = 'fas fa-check';
                        icon.style.display = 'inline-block';
                    } else {
                        icon.style.display = 'none';
                    }
                });
                
                showNotification(translations[lang].language_changed || "Language changed successfully!");
            }
        }

        function updateTranslations() {
            const langData = translations[currentLanguage] || translations['en'];
            
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.dataset.translate;
                if (langData[key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = langData[key];
                    } else {
                        element.textContent = langData[key];
                    }
                }
            });
        }

        // Theme Management
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            updateTheme();
            localStorage.setItem('theme', isDarkTheme ? 'dark' : 'light');
        }

        function updateTheme() {
            const body = document.body;
            const themeIcon = document.querySelector('#themeToggle i');
            
            if (isDarkTheme) {
                body.classList.remove('light-theme');
                themeIcon.className = 'fas fa-sun';
            } else {
                body.classList.add('light-theme');
                themeIcon.className = 'fas fa-moon';
            }
        }

        // Authentication
        function handleGoogleLogin() {
            // Simulate Google login
            currentUser = {
                id: '1',
                name: 'John Doe',
                email: 'john.doe@example.com',
                avatar: 'https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=64&h=64&dpr=2'
            };
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            showMainContent();
        }

        function logout() {
            currentUser = null;
            machines = [];
            dataEntries = [];
            operators = {};
            localStorage.removeItem('currentUser');
            localStorage.removeItem('machines');
            localStorage.removeItem('dataEntries');
            localStorage.removeItem('operators');
            hideProfileDropdown();
            showLoginPage();
        }

        // Navigation
        function showLoginPage() {
            hideAllViews();
            document.getElementById('loginPage').style.display = 'flex';
            currentView = 'login';
        }

        function showMainContent() {
            try {
                hideAllViews();
                const mainContent = document.getElementById('mainContent');
                if (!mainContent) {
                    throw new Error('Main content element not found');
                }
                
                // Show loading state
                mainContent.classList.add('loading');
                mainContent.style.display = 'block';
                currentView = 'main';
                
                // Update dashboard with a slight delay to show loading state
                setTimeout(() => {
                    updateDashboard();
                    mainContent.classList.remove('loading');
                }, 300);
                
            } catch (error) {
                console.error('Error showing main content:', error);
                showNotification('An error occurred while loading the dashboard', 'error');
            }
        }

        function showMachineTypeView(type) {
            hideAllViews();
            document.getElementById('machineTypeView').style.display = 'block';
            currentView = 'machineType';
            currentMachineType = type;
            updateMachineTypeView(type);
        }

        function showMachineDetails(machineId) {
            hideAllViews();
            document.getElementById('machineDetailsView').style.display = 'block';
            currentView = 'machineDetails';
            currentMachine = machines.find(m => m.id === machineId);
            updateMachineDetailsView();
        }

        function showOperatorsView() {
            hideAllViews();
            document.getElementById('operatorsView').style.display = 'block';
            currentView = 'operators';
            updateOperatorsView();
        }

        function showOperatorDetails(operatorName) {
            currentOperator = operatorName;
            const operatorData = operators[operatorName];
            
            document.getElementById('operatorDetailsTitle').textContent = operatorName;
            
            // Calculate total hours and products
            let totalHours = 0;
            let totalProducts = 0;
            let machineStats = {};
            
            dataEntries.forEach(entry => {
                if (entry.operatorName === operatorName) {
                    totalHours += entry.workingHours;
                    totalProducts += entry.productsManufactured;
                    
                    const machine = machines.find(m => m.id === entry.machineId);
                    if (machine) {
                        if (!machineStats[machine.id]) {
                            machineStats[machine.id] = {
                                name: machine.name,
                                type: machine.type,
                                hours: 0,
                                products: 0
                            };
                        }
                        machineStats[machine.id].hours += entry.workingHours;
                        machineStats[machine.id].products += entry.productsManufactured;
                    }
                }
            });
            
            // Get badge level
            const badgeLevel = getBadgeLevel(totalHours);
            
            // Update modal content
            const content = document.getElementById('operatorDetailsContent');
            content.innerHTML = `
                <div class="operator-info">
                    <div class="operator-badge ${badgeLevel.class}">
                        <i class="fas ${badgeLevel.icon}"></i>
                        <span>${badgeLevel.name}</span>
                    </div>
                    <div class="operator-stats-grid">
                        <div class="stat-card">
                            <i class="fas fa-clock"></i>
                            <div class="stat-value">${totalHours.toFixed(1)}h</div>
                            <div class="stat-label">${translations[currentLanguage].total_hours || "Total Hours"}</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-box"></i>
                            <div class="stat-value">${totalProducts}</div>
                            <div class="stat-label">${translations[currentLanguage].total_products || "Total Products"}</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-chart-line"></i>
                            <div class="stat-value">${totalHours > 0 ? (totalProducts / totalHours).toFixed(2) : 0}</div>
                            <div class="stat-label">${translations[currentLanguage].efficiency || "Efficiency"}</div>
                        </div>
                    </div>
                </div>
                
                <h3 style="margin: 2rem 0 1rem;">${translations[currentLanguage].machine_performance || "Machine Performance"}</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>${translations[currentLanguage].machine_name || "Machine"}</th>
                                <th>${translations[currentLanguage].type || "Type"}</th>
                                <th>${translations[currentLanguage].hours || "Hours"}</th>
                                <th>${translations[currentLanguage].products || "Products"}</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${Object.values(machineStats).map(machine => `
                                <tr>
                                    <td>${machine.name}</td>
                                    <td>${machine.type}</td>
                                    <td>${machine.hours.toFixed(1)}h</td>
                                    <td>${machine.products}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                
                <div class="chart-container" style="margin-top: 2rem; height: 300px;">
                    <canvas id="operatorChart"></canvas>
                </div>
            `;
            
            // Show chart
            const ctx = document.getElementById('operatorChart');
            if (operatorChart) {
                operatorChart.destroy();
            }
            
            const machineNames = Object.values(machineStats).map(m => m.name);
            const machineHours = Object.values(machineStats).map(m => m.hours);
            
            operatorChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: machineNames,
                    datasets: [{
                        label: translations[currentLanguage].hours_operated || 'Hours Operated',
                        data: machineHours,
                        backgroundColor: '#ff8c00'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#999999'
                            },
                            grid: {
                                color: '#333333'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#999999'
                            },
                            grid: {
                                color: '#333333'
                            }
                        }
                    }
                }
            });
            
            showModal('operatorDetailsModal');
        }

        function showAnalyticsPage() {
            hideAllViews();
            document.getElementById('analyticsPage').style.display = 'block';
            currentView = 'analytics';
            updateAnalyticsPage();
        }

        function showInsightsPage() {
            hideAllViews();
            document.getElementById('insightsPage').style.display = 'block';
            currentView = 'insights';
            updateInsightsPage();
        }

        function hideAllViews() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('machineTypeView').style.display = 'none';
            document.getElementById('machineDetailsView').style.display = 'none';
            document.getElementById('operatorsView').style.display = 'none';
            document.getElementById('analyticsPage').style.display = 'none';
            document.getElementById('insightsPage').style.display = 'none';
        }

        // Profile Dropdown
        function toggleProfileDropdown() {
            const dropdown = document.getElementById('profileDropdown');
            dropdown.classList.toggle('show');
        }

        function hideProfileDropdown() {
            document.getElementById('profileDropdown').classList.remove('show');
        }

        // Modal Management
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
            clearFormErrors();
        }

        function hideAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('show');
            });
            clearFormErrors();
        }

        // Form Validation
        function validateForm(formId) {
            const form = document.getElementById(formId);
            const formData = new FormData(form);
            let isValid = true;
            
            clearFormErrors();
            
            if (formId === 'addMachineForm') {
                const name = formData.get('machineName').trim();
                const type = formData.get('machineType');
                
                if (!name) {
                    showFieldError('machineName', translations[currentLanguage].machine_name_required || 'Machine name is required');
                    isValid = false;
                }
                
                if (!type) {
                    showFieldError('machineType', translations[currentLanguage].machine_type_required || 'Machine type is required');
                    isValid = false;
                }
                
                // Check for duplicate names
                if (name && machines.some(m => m.name.toLowerCase() === name.toLowerCase())) {
                    showFieldError('machineName', translations[currentLanguage].machine_name_exists || 'Machine name already exists');
                    isValid = false;
                }
            }
            
            if (formId === 'addDataEntryForm') {
                const date = formData.get('entryDate');
                const operator = formData.get('operatorName').trim();
                const hours = parseFloat(formData.get('workingHours'));
                const products = parseInt(formData.get('productsManufactured'));
                
                if (!date) {
                    showFieldError('entryDate', translations[currentLanguage].date_required || 'Date is required');
                    isValid = false;
                }
                
                if (!operator) {
                    showFieldError('operatorName', translations[currentLanguage].operator_name_required || 'Operator name is required');
                    isValid = false;
                }
                
                if (!hours || hours <= 0) {
                    showFieldError('workingHours', translations[currentLanguage].hours_positive || 'Working hours must be greater than 0');
                    isValid = false;
                } else if (hours > 24) {
                    showFieldError('workingHours', translations[currentLanguage].hours_max || 'Working hours cannot exceed 24');
                    isValid = false;
                }
                
                if (products === undefined || products < 0) {
                    showFieldError('productsManufactured', translations[currentLanguage].products_positive || 'Products manufactured must be 0 or greater');
                    isValid = false;
                }
                
                // Check for duplicate date entries for current machine
                if (date && currentMachine) {
                    const existingEntry = dataEntries.find(e => 
                        e.machineId === currentMachine.id && e.date === date && e.operatorName === operator
                    );
                    if (existingEntry) {
                        showFieldError('entryDate', translations[currentLanguage].entry_exists || 'Data entry for this date and operator already exists');
                        isValid = false;
                    }
                }
            }
            
            return isValid;
        }

        function showFieldError(fieldName, message) {
            const field = document.getElementById(fieldName);
            const errorElement = document.getElementById(fieldName + 'Error');
            
            if (field && errorElement) {
                field.closest('.form-group').classList.add('error');
                errorElement.textContent = message;
                errorElement.classList.add('show');
            }
        }

        function clearFormErrors() {
            document.querySelectorAll('.form-group').forEach(group => {
                group.classList.remove('error');
            });
            document.querySelectorAll('.error-message').forEach(error => {
                error.classList.remove('show');
                error.textContent = '';
            });
        }

        // Machine Management
        function handleAddMachine(e) {
            e.preventDefault();
            
            if (!validateForm('addMachineForm')) {
                return;
            }
            
            const formData = new FormData(e.target);
            const machine = {
                id: generateId(),
                name: formData.get('machineName').trim(),
                type: formData.get('machineType'),
                status: 'active',
                dateAdded: new Date().toISOString()
            };
            
            machines.push(machine);
            saveDataToStorage();
            updateDashboard();
            
            // Reset form and close modal
            e.target.reset();
            hideModal('addMachineModal');
            
            showNotification(translations[currentLanguage].machine_added || 'Machine added successfully!');
        }

        function handleAddLine(e) {
            e.preventDefault();
            
            const slots = document.querySelectorAll('.machine-slot');
            const validMachines = [];
            let hasErrors = false;
            
            clearFormErrors();
            
            slots.forEach((slot, index) => {
                const nameInput = slot.querySelector('input[name="machineName"]');
                const typeSelect = slot.querySelector('select[name="machineType"]');
                
                const name = nameInput.value.trim();
                const type = typeSelect.value;
                
                if (name || type) {
                    if (!name) {
                        showSlotError(slot, 'name', translations[currentLanguage].machine_name_required || 'Machine name is required');
                        hasErrors = true;
                    }
                    if (!type) {
                        showSlotError(slot, 'type', translations[currentLanguage].machine_type_required || 'Machine type is required');
                        hasErrors = true;
                    }
                    
                    // Check for duplicate names
                    if (name && machines.some(m => m.name.toLowerCase() === name.toLowerCase())) {
                        showSlotError(slot, 'name', translations[currentLanguage].machine_name_exists || 'Machine name already exists');
                        hasErrors = true;
                    }
                    
                    if (name && type && !hasErrors) {
                        validMachines.push({ name, type });
                    }
                }
            });
            
            if (hasErrors) {
                return;
            }
            
            if (validMachines.length === 0) {
                showNotification(translations[currentLanguage].add_one_machine || 'Please add at least one machine', 'error');
                return;
            }
            
            // Add all valid machines
            validMachines.forEach(machineData => {
                const machine = {
                    id: generateId(),
                    name: machineData.name,
                    type: machineData.type,
                    status: 'active',
                    dateAdded: new Date().toISOString()
                };
                machines.push(machine);
            });
            
            saveDataToStorage();
            updateDashboard();
            
            // Reset form and close modal
            e.target.reset();
            initializeLineModal();
            hideModal('addLineModal');
            
            showNotification(`${validMachines.length} ${translations[currentLanguage].machines_added || 'machines added successfully!'}`);
        }

        function showSlotError(slot, field, message) {
            const input = slot.querySelector(`[name="machine${field === 'name' ? 'Name' : 'Type'}"]`);
            input.style.borderColor = '#ff6b6b';
            
            // Create or update error message
            let errorElement = slot.querySelector(`.slot-error-${field}`);
            if (!errorElement) {
                errorElement = document.createElement('div');
                errorElement.className = `error-message slot-error-${field} show`;
                input.parentNode.appendChild(errorElement);
            }
            errorElement.textContent = message;
            errorElement.classList.add('show');
        }

        function handleAddDataEntry(e) {
            e.preventDefault();
            
            if (!validateForm('addDataEntryForm')) {
                return;
            }
            
            const formData = new FormData(e.target);
            const operatorName = formData.get('operatorName').trim();
            const hours = parseFloat(formData.get('workingHours'));
            const products = parseInt(formData.get('productsManufactured'));
            
            const dataEntry = {
                id: generateId(),
                machineId: currentMachine.id,
                operatorName: operatorName,
                date: formData.get('entryDate'),
                workingHours: hours,
                productsManufactured: products,
                efficiency: hours > 0 ? (products / hours).toFixed(2) : 0,
                notes: formData.get('notes') || '',
                dateAdded: new Date().toISOString()
            };
            
            dataEntries.push(dataEntry);
            
            // Update operator data
            if (!operators[operatorName]) {
                operators[operatorName] = {
                    totalHours: 0,
                    totalProducts: 0,
                    machines: {}
                };
            }
            
            operators[operatorName].totalHours += hours;
            operators[operatorName].totalProducts += products;
            
            if (!operators[operatorName].machines[currentMachine.id]) {
                operators[operatorName].machines[currentMachine.id] = {
                    hours: 0,
                    products: 0
                };
            }
            
            operators[operatorName].machines[currentMachine.id].hours += hours;
            operators[operatorName].machines[currentMachine.id].products += products;
            
            saveDataToStorage();
            updateMachineDetailsView();
            
            // Reset form and close modal
            e.target.reset();
            hideModal('addDataEntryModal');
            
            showNotification(translations[currentLanguage].entry_added || 'Data entry added successfully!');
        }

        // Line Modal Management
        function initializeLineModal() {
            const container = document.getElementById('machineSlots');
            container.innerHTML = '';
            // Add 3 initial slots
            for (let i = 0; i < 3; i++) {
                addMachineSlot();
            }
        }

        function addMachineSlot() {
            const container = document.getElementById('machineSlots');
            const slotIndex = container.children.length;
            
            const slot = document.createElement('div');
            slot.className = 'machine-slot';
            slot.innerHTML = `
                <div class="form-group">
                    <label for="machineName${slotIndex}" data-translate="machine_name">Machine Name</label>
                    <input type="text" id="machineName${slotIndex}" name="machineName" required>
                </div>
                <div class="form-group">
                    <label for="machineType${slotIndex}" data-translate="machine_type">Machine Type</label>
                    <select id="machineType${slotIndex}" name="machineType" required>
                        <option value="" data-translate="select_machine_type">Select machine type</option>
                        <option value="Milling" data-translate="milling">Milling</option>
                        <option value="Grinding" data-translate="grinding">Grinding</option>
                        <option value="Cutting" data-translate="cutting">Cutting</option>
                    </select>
                </div>
            `;
            
            // Apply translations to the new elements
            const langData = translations[currentLanguage] || translations['en'];
            const labels = slot.querySelectorAll('[data-translate]');
            labels.forEach(label => {
                const key = label.dataset.translate;
                if (langData[key]) {
                    if (label.tagName === 'OPTION') {
                        label.textContent = langData[key];
                    } else {
                        label.textContent = langData[key];
                    }
                }
            });
            
            container.appendChild(slot);
        }

        function initializeDataEntryModal() {
            const form = document.getElementById('addDataEntryForm');
            form.reset();
            
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('entryDate').value = today;
        }

        // Tab Switching
        function switchTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tabName);
            });
            
            // Show active tab content
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.toggle('active', pane.id === `${tabName}Tab`);
            });
            
            // Load content if needed
            if (tabName === 'analytics' && currentView === 'machineDetails') {
                updateMachineAnalytics();
            }
        }

        // Chart Switching
        function switchChart(chartType) {
            if (currentView === 'machineDetails') {
                updateMachineAnalytics(chartType);
            }
            
            // Update active chart button
            document.querySelectorAll('.chart-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.chart === chartType);
            });
        }

        function switchMetric(metricType) {
            if (currentView === 'analytics') {
                updateTimeSeriesChart(metricType);
            }
            
            // Update active metric button
            document.querySelectorAll('.metric-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.metric === metricType);
            });
        }

        function switchTimeRange(range) {
            if (currentView === 'analytics') {
                updateAnalyticsPage(range);
            }
            
            // Update active time button
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.range === range);
            });
        }

        // UI Updates
        function updateDashboard() {
            if (currentView !== 'main') return;
            
            // Update machine type counts
            const typeCounts = {
                Milling: 0,
                Grinding: 0,
                Cutting: 0
            };
            
            machines.forEach(machine => {
                if (typeCounts.hasOwnProperty(machine.type)) {
                    typeCounts[machine.type]++;
                }
            });
            
            document.getElementById('millingCount').textContent = typeCounts.Milling;
            document.getElementById('grindingCount').textContent = typeCounts.Grinding;
            document.getElementById('cuttingCount').textContent = typeCounts.Cutting;
            
            // Update quick stats
            document.getElementById('totalMachines').textContent = machines.length;
            document.getElementById('activeMachines').textContent = machines.filter(m => m.status === 'active').length;
            document.getElementById('totalEntries').textContent = dataEntries.length;
            
            const totalProducts = dataEntries.reduce((sum, entry) => sum + entry.productsManufactured, 0);
            document.getElementById('totalProducts').textContent = totalProducts;
            
            // Update user profile
            if (currentUser) {
                document.querySelector('.profile-name').textContent = currentUser.name;
                document.querySelector('.profile-img').src = currentUser.avatar;
            }
        }

        function updateInsightsPage() {
            if (currentView !== 'insights') return;
            
            // Update machine type counts
            const typeCounts = {
                Milling: 0,
                Grinding: 0,
                Cutting: 0
            };
            
            machines.forEach(machine => {
                if (typeCounts.hasOwnProperty(machine.type)) {
                    typeCounts[machine.type]++;
                }
            });
            
            document.getElementById('millingCount').textContent = typeCounts.Milling;
            document.getElementById('grindingCount').textContent = typeCounts.Grinding;
            document.getElementById('cuttingCount').textContent = typeCounts.Cutting;
        }

        function updateMachineTypeView(type) {
            const typeMachines = machines.filter(m => m.type === type);
            
            // Update header
            document.getElementById('machineTypeName').textContent = `${type} ${translations[currentLanguage].machines || 'Machines'}`;
            document.getElementById('machineTypeCount').textContent = `${typeMachines.length} ${translations[currentLanguage].machines_in_category || 'machines in this category'}`;

            // Clear the grid first
            const grid = document.getElementById('machinesGrid');
            grid.innerHTML = '';

            if (type === 'Milling') {
                // Hide all old interface elements
                const predictionInterface = document.getElementById('predictionInterface');
                const temperatureInterface = document.getElementById('temperatureInterface');
                const historicalInterface = document.getElementById('historicalInterface');
                const energyCostSection = document.querySelector('.energy-cost-insight');
                const shiftDelaySection = document.querySelector('.shift-delay-insight');
                const coolantSection = document.querySelector('.coolant-monitor-section');

                if (predictionInterface) predictionInterface.style.display = 'none';
                if (temperatureInterface) temperatureInterface.style.display = 'none';
                if (historicalInterface) historicalInterface.style.display = 'none';
                if (energyCostSection) energyCostSection.style.display = 'none';
                if (shiftDelaySection) shiftDelaySection.style.display = 'none';
                if (coolantSection) coolantSection.style.display = 'none';

                // Add new UI elements for Milling
                grid.innerHTML = `
                    <div class="analytics-container" style="background:#111;border:1px solid #333;border-radius:12px;padding:2rem;margin-top:2rem;color:#fff;">
                        <!-- Coolant Consumption Section -->
                        <div style="margin-bottom:2rem;">
                            <h2 style="font-size:1.5rem;margin-bottom:1.5rem;">Coolant Consumption Spike – Monitoring & Anomaly Detection</h2>
                            <div style="display:grid;grid-template-columns:1fr 2fr;gap:2rem;">
                                <div style="background:#222;padding:1.5rem;border-radius:8px;">
                                    <h3>LIVE COULANT USAGE</h3>
                                    <div style="font-size:2.5rem;font-weight:bold;margin:1rem 0;">6.2 L/min</div>
                                    <div style="height:20px;background:#333;border-radius:4px;margin:1rem 0;">
                                        <div style="width:80%;height:100%;background:#ff8c00;border-radius:4px;"></div>
                                    </div>
                                    <div>Daily usage aboveline</div>
                                </div>
                                <div style="background:#222;padding:1.5rem;border-radius:8px;">
                                    <h3>COOLANT TREND (LAST 48H)</h3>
                                    <canvas id="coolantTrendChart" style="width:100%;height:200px;"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Tool Life Section -->
                        <div style="margin-bottom:2rem;">
                            <h2 style="font-size:1.5rem;margin-bottom:1.5rem;">TOOL LIFE CONSUMPTION</h2>
                            <div style="display:grid;grid-template-columns:2fr 1fr;gap:2rem;background:#222;padding:1.5rem;border-radius:8px;">
                                <div>
                                    <canvas id="toolLifeChart" style="width:100%;height:150px;"></canvas>
                                    <ul style="margin-top:1rem;">
                                        <li>Replace tool at 80% to avoid part defects</li>
                                        <li>Adjust feed rate to extend tool life</li>
                                        <li>Enable vibration alert for sudden wear</li>
                                    </ul>
                                </div>
                                <div style="display:flex;align-items:center;justify-content:center;">
                                    <div style="font-size:3rem;font-weight:bold;">68%</div>
                                </div>
                            </div>
                        </div>

                        <!-- Shift-Start Delay Section -->
                        <div style="margin-bottom:2rem;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
                                <h2 style="font-size:1.5rem;">SHIFT-START DELAY</h2>
                                <button class="export-btn">EXPORT</button>
                            </div>
                            <div style="background:#222;padding:1.5rem;border-radius:8px;">
                                <h3 style="margin-bottom:1rem;">SHIFT-WISE DELAY HISTORY</h3>
                                <div style="height:200px;position:relative;margin-bottom:1.5rem;">
                                    <canvas id="shiftDelayHistoryChart" style="width:100%;height:100%;"></canvas>
                                </div>
                                <!-- Weekly Shift Performance -->
                                <div style="margin-bottom:1.5rem;">
                                    <h4 style="font-size:1rem;color:#999;margin-bottom:0.5rem;">WEEKLY SHIFT PERFORMANCE</h4>
                                    <div style="display:grid;grid-template-columns:auto 1fr;gap:1rem;align-items:center;">
                                        <div style="color:#999;font-size:0.9rem;">
                                            <div>Shift A</div>
                                            <div>Shift B</div>
                                            <div>Shift C</div>
                                        </div>
                                        <div style="height:100px;position:relative;">
                                            <canvas id="weeklyShiftPerformanceChart" style="width:100%;height:100%;"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;">
                                    <div>
                                        <h4 style="margin-bottom:1rem;">OPERATOR-LEVEL ANALYSIS</h4>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:0.5rem;">
                                            <span>MARKUS</span>
                                            <span>18 mins</span>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:0.5rem;">
                                            <span>TOBIAS</span>
                                            <span>7 mins</span>
                                        </div>
                                        <div style="margin-top:1.5rem;">
                                            <h4 style="margin-bottom:0.5rem;">ALERT SETTINGS & THRESHOLDS</h4>
                                            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem;">
                                                <span style="color:#FFC107;">✓</span>
                                                <span>SMS to Supervisor</span>
                                            </div>
                                            <div style="display:flex;align-items:center;gap:0.5rem;">
                                                <span style="color:#FFC107;">✓</span>
                                                <span>Popup on Dashboard</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 style="margin-bottom:1rem;">CONTRIBUTING FACTORS LOG</h4>
                                        <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem;">
                                            <span style="color:#FFC107;">✓</span>
                                            <span>Machine not powered by maintenance</span>
                                        </div>
                                        <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.5rem;">
                                            <span style="color:#666;">□</span>
                                            <span>No operator badge scan</span>
                                        </div>
                                        <div style="display:flex;align-items:center;gap:0.5rem;">
                                            <span style="color:#666;">□</span>
                                            <span>Coolant tank refill</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Historical Trend Section -->
                        <div style="margin-bottom:2rem;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
                                <h2 style="font-size:1.5rem;">HISTORICAL TREND</h2>
                                <button class="export-btn">EXPORT PDF</button>
                            </div>
                            <div style="background:#222;padding:1.5rem;border-radius:8px;">
                                <canvas id="historicalTrendChart" style="width:100%;height:200px;"></canvas>
                                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:2rem;margin-top:1rem;">
                                    <div>
                                        <h3>OPERATORS</h3>
                                        <div>Operator 3</div>
                                        <div>Shift A Avg. 2,7</div>
                                        <div>Shift B Avg. 3,9</div>
                                        <div>Shift C Avg. 4,4</div>
                                    </div>
                                    <div>
                                        <h3>PREDICTION</h3>
                                        <div>NEXT CHANGEOVER DELAY LIKELY</div>
                                        <div style="font-size:2rem;margin:1rem 0;">4.2 min</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Energy Cost Section -->
                        <div>
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
                                <h2 style="font-size:1.5rem;">ENERGY COST PER PART</h2>
                                <button class="export-btn">EXPORT PDF</button>
                            </div>
                            <div style="background:#222;padding:1.5rem;border-radius:8px;">
                                <canvas id="energyCostChart" style="width:100%;height:200px;"></canvas>
                                <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-top:1rem;">
                                    <div>
                                        <h3>INFLUENCING FACTORS</h3>
                                        <div>Vibration Level ↑2% vs avg</div>
                                        <div>Power Idle Time ↑18 mins today</div>
                                    </div>
                                    <div>
                                        <h3>COMPARISON</h3>
                                        <div>Shift A vs Shift B Avg cost/part</div>
                                        <div>Part Type A vs B Energy deviation</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // Initialize all the charts
                initializeMillingCharts();
            } else if (type === 'Grinding') {
                // Show original prediction interface
                updatePredictionInterface(type);
            } else if (type === 'Cutting') {
                grid.innerHTML = `<div class="empty-state">No insights available for Cutting machines</div>`;
                return;
            }
            
            // Update header
            document.getElementById('machineTypeName').textContent = `${type} ${translations[currentLanguage].machines || 'Machines'}`;
            document.getElementById('machineTypeCount').textContent = `${typeMachines.length} ${translations[currentLanguage].machines_in_category || 'machines in this category'}`;
            
            // Update icon
            const iconMap = {
                Milling: 'fa-cog',
                Grinding: 'fa-bolt',
                Cutting: 'fa-cut'
            };
            
            const iconElement = document.getElementById('typeIcon').querySelector('i');
            iconElement.className = `fas ${iconMap[type] || 'fa-cog'}`;
            
            // Populate machines grid
            // For Milling and Cutting, just show a message
            if (type === 'Milling' || type === 'Cutting') {
                grid.innerHTML = `<div class="empty-state">No data available for ${type} machines</div>`;
                return;
            }
            
            if (typeMachines.length === 0) {
                grid.innerHTML = `<div class="empty-state">${translations[currentLanguage].no_machines_found || 'No machines found in this category'}</div>`;
                return;
            }
            
            typeMachines.forEach(machine => {
                const machineCard = document.createElement('div');
                machineCard.className = 'machine-item';
                machineCard.innerHTML = `
                    <div class="machine-item-header">
                        <h3>${machine.name}</h3>
                        <span class="status-badge ${machine.status}">${machine.status}</span>
                    </div>
                    <div class="machine-item-meta">
                        <span><i class="fas fa-calendar"></i> ${formatDate(machine.dateAdded)}</span>
                    </div>
                    <div class="machine-item-footer">
                        <button class="btn btn-outline view-machine-btn" data-id="${machine.id}">
                            <i class="fas fa-eye"></i> ${translations[currentLanguage].view_details || 'View Details'}
                        </button>
                    </div>
                `;
                
                machineCard.querySelector('.view-machine-btn').addEventListener('click', () => {
                    showMachineDetails(machine.id);
                });
                
                grid.appendChild(machineCard);
            });

            // Update prediction interface only for Grinding
            if (type === 'Grinding') {
                updatePredictionInterface(type);
            }
        }

        function updatePredictionInterface(type) {
            // Get all interface elements
            const predictionInterface = document.getElementById('predictionInterface');
            const temperatureInterface = document.getElementById('temperatureInterface');
            const historicalInterface = document.getElementById('historicalInterface');
            const energyCostSection = document.querySelector('.energy-cost-insight');
            const shiftDelaySection = document.querySelector('.shift-delay-insight');
            const coolantSection = document.querySelector('.coolant-monitor-section');
            
            // Hide all sections by default
            if (predictionInterface) predictionInterface.style.display = 'none';
            if (temperatureInterface) temperatureInterface.style.display = 'none';
            if (historicalInterface) historicalInterface.style.display = 'none';
            if (energyCostSection) energyCostSection.style.display = 'none';
            if (shiftDelaySection) shiftDelaySection.style.display = 'none';
            if (coolantSection) coolantSection.style.display = 'none';
            
            // Don't show old interfaces for Milling type
            if (type === 'Milling') {
                return;
            }

            // Only show sections for Grinding type
            if (type === 'Grinding') {
                // Show all interfaces
                predictionInterface.style.display = 'block';
                temperatureInterface.style.display = 'block';
                historicalInterface.style.display = 'block';
                energyCostSection.style.display = 'block';
                shiftDelaySection.style.display = 'block';
                coolantSection.style.display = 'block';
                
                // Update content for Grinding and Cutting
                const predictionData = {
                    Grinding: {
                        title: 'GRINDING WHEEL DULLNESS PREDICTION',
                        icon: 'fa-bolt',
                        triggerEvents: 'Dullness detected after part #184. Related alert: Slight increase in defect rate after dullness onset',
                        aiRecommendation: 'Predicted time to replacement: ~47 parts.<br>Wheel dressing now',
                        shifts: [
                            { name: 'Shift A: Avg. power draw 8.6 kW', value: 'Shift B: Avg. power draw 9.0 kW' },
                            { name: 'Shift C: Avg. power draw 8.4 kW', value: '' }
                        ],
                        note: '(more power consumption can be due to dull wheel or aggressive cutting)',
                        temperature: {
                            title: 'GRINDING WHEEL TEMPERATURE',
                            live: '72.8°C',
                            status: 'ELEVATED TEMPERATURE',
                            change: '+4.2°C LAST HOUR',
                            causes: ['CHECK COOLANT FLOW', 'INSPECT WHEEL BALANCE', 'REDUCE GRINDING PRESSURE']
                        }
                    },
                    Cutting: {
                        title: 'CUTTING BLADE DEGRADATION PREDICTION',
                        icon: 'fa-cut',
                        triggerEvents: 'Blade degradation detected after part #98. Related alert: Increased cutting force and vibration levels',
                        aiRecommendation: 'Predicted time to replacement: ~25 parts.<br>Blade replacement recommended',
                        shifts: [
                            { name: 'Shift A: Avg. power draw 6.8 kW', value: 'Shift B: Avg. power draw 7.3 kW' },
                            { name: 'Shift C: Avg. power draw 6.9 kW', value: '' }
                        ],
                        note: '(increased power indicates blade wear or material hardness variation)',
                        temperature: {
                            title: 'CUTTING ZONE TEMPERATURE',
                            live: '65.2°C',
                            status: 'NORMAL RANGE',
                            change: '+2.1°C LAST HOUR',
                            causes: ['CHECK CUTTING FLUID', 'VERIFY BLADE SHARPNESS', 'ADJUST FEED RATE']
                        }
                    }
                };
                const data = predictionData[type];
                if (!data) return;
                // ...existing code for updating Grinding and Cutting...
                document.getElementById('predictionTitle').textContent = data.title;
                const predictionIconElement = document.getElementById('predictionIcon').querySelector('i');
                predictionIconElement.className = `fas ${data.icon}`;
                document.getElementById('triggerEvents').textContent = data.triggerEvents;
                document.getElementById('aiRecommendation').innerHTML = data.aiRecommendation;
                const shiftContainer = document.querySelector('.shift-comparison');
                const shiftItems = shiftContainer.querySelectorAll('.shift-item');
                data.shifts.forEach((shift, index) => {
                    if (shiftItems[index]) {
                        shiftItems[index].innerHTML = `
                            <span>${shift.name}</span>
                            <span>${shift.value}</span>
                        `;
                    }
                });
                document.getElementById('shiftNote').textContent = data.note;
                updateTemperatureInterface(data.temperature);
            }
        }

        function updateTemperatureInterface(tempData) {
            document.getElementById('temperatureTitle').textContent = tempData.title;
            document.getElementById('liveTemp').textContent = tempData.live;
            document.getElementById('tempStatus').textContent = tempData.status;
            document.getElementById('tempChange').textContent = tempData.change;
            
            // Update root cause list
            const causeList = document.getElementById('rootCauseList');
            causeList.innerHTML = '';
            tempData.causes.forEach(cause => {
                const li = document.createElement('li');
                li.textContent = cause;
                causeList.appendChild(li);
            });
        }

        function updateMachineDetailsView() {
            if (!currentMachine) return;
            
            // Update header
            document.getElementById('machineDetailsName').textContent = currentMachine.name;
            document.getElementById('machineDetailsBadge').textContent = currentMachine.type;
            
            const addedDate = new Date(currentMachine.dateAdded);
            const today = new Date();
            const diffTime = Math.abs(today - addedDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            let addedText = '';
            if (diffDays === 0) {
                addedText = translations[currentLanguage].added_today || 'Added today';
            } else if (diffDays === 1) {
                addedText = translations[currentLanguage].added_yesterday || 'Added yesterday';
            } else {
                addedText = `${translations[currentLanguage].added || 'Added'} ${diffDays} ${translations[currentLanguage].days_ago || 'days ago'}`;
            }
            
            document.getElementById('machineDetailsDate').textContent = addedText;
            
            // Get machine entries
            const machineEntries = dataEntries.filter(e => e.machineId === currentMachine.id);
            
            // Update stats
            
            document.getElementById('machineDataEntries').textContent = machineEntries.length;
            
            const totalHours = machineEntries.reduce((sum, entry) => sum + entry.workingHours, 0);
            document.getElementById('machineTotalHours').textContent = `${totalHours.toFixed(1)}h`;
            
            const totalProducts = machineEntries.reduce((sum, entry) => sum + entry.productsManufactured, 0);
            document.getElementById('machineTotalProducts').textContent = totalProducts;
            
            const efficiency = totalHours > 0 ? (totalProducts / totalHours).toFixed(2) : 0;
            document.getElementById('machineEfficiency').textContent = efficiency;
            
            // Update data entries table
            const tableBody = document.querySelector('#dataEntriesTable tbody');
            tableBody.innerHTML = '';
            
            if (machineEntries.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="empty-table">${translations[currentLanguage].no_data_entries || 'No data entries found for this machine'}</td>
                    </tr>
                `;
            } else {
                machineEntries.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(entry => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDate(entry.date)}</td>
                        <td>${entry.operatorName}</td>
                        <td>${entry.workingHours.toFixed(1)}h</td>
                        <td>${entry.productsManufactured}</td>
                        <td>${entry.efficiency}</td>
                        <td>${entry.notes || '-'}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }
            
            // Update operators list
            updateOperatorsTab();
            
            // Update analytics tab
            updateMachineAnalytics();
        }

        function updateOperatorsTab() {
            if (!currentMachine) return;
            
            const container = document.getElementById('operatorsList');
            const machineEntries = dataEntries.filter(e => e.machineId === currentMachine.id);
            
            // Get unique operators
            const operatorStats = {};
            
            machineEntries.forEach(entry => {
                if (!operatorStats[entry.operatorName]) {
                    operatorStats[entry.operatorName] = {
                        hours: 0,
                        products: 0,
                        entries: 0
                    };
                }
                
                operatorStats[entry.operatorName].hours += entry.workingHours;
                operatorStats[entry.operatorName].products += entry.productsManufactured;
                operatorStats[entry.operatorName].entries++;
            });
            
            container.innerHTML = '';
            
            if (Object.keys(operatorStats).length === 0) {
                container.innerHTML = `<div class="empty-state">${translations[currentLanguage].no_operator_data || 'No operator data available'}</div>`;
                return;
            }
            
            Object.entries(operatorStats).forEach(([name, stats]) => {
                const efficiency = stats.hours > 0 ? (stats.products / stats.hours).toFixed(2) : 0;
                const badgeLevel = getBadgeLevel(stats.hours);
                
                const operatorCard = document.createElement('div');
                operatorCard.className = 'operator-card';
                operatorCard.innerHTML = `
                    <div class="operator-info">
                        <h3>${name}</h3>
                        <div class="operator-badge ${badgeLevel.class}">
                            <i class="fas ${badgeLevel.icon}"></i>
                            <span>${badgeLevel.name}</span>
                        </div>
                    </div>
                    <div class="operator-stats">
                        <div class="stat-item">
                            <span class="stat-value">${stats.hours.toFixed(1)}h</span>
                            <span class="stat-label">${translations[currentLanguage].hours || 'Hours'}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">${stats.products}</span>
                            <span class="stat-label">${translations[currentLanguage].products || 'Products'}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">${efficiency}</span>
                            <span class="stat-label">${translations[currentLanguage].efficiency || 'Efficiency'}</span>
                        </div>
                    </div>
                    <button class="btn btn-outline view-operator-btn">
                        <i class="fas fa-user"></i> ${translations[currentLanguage].view_details || 'View Details'}
                    </button>
                `;
                
                operatorCard.querySelector('.view-operator-btn').addEventListener('click', () => {
                    showOperatorDetails(name);
                });
                
                container.appendChild(operatorCard);
            });
        }

        function initializeMillingCharts() {
            // Coolant Trend Chart
            const coolantCtx = document.getElementById('coolantTrendChart').getContext('2d');
            new Chart(coolantCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 48}, (_, i) => i),
                    datasets: [{
                        data: Array.from({length: 48}, () => Math.random() * 20 + 60),
                        borderColor: '#ff8c00',
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: '#333' }, ticks: { color: '#fff' } },
                        x: { grid: { color: '#333' }, ticks: { color: '#fff' } }
                    }
                }
            });

            // Tool Life Chart
            const toolCtx = document.getElementById('toolLifeChart').getContext('2d');
            new Chart(toolCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 20}, (_, i) => i),
                    datasets: [{
                        data: Array.from({length: 20}, (_, i) => 68 + Math.sin(i/3) * 5),
                        borderColor: '#ff8c00',
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: '#333' }, ticks: { color: '#fff' } },
                        x: { grid: { color: '#333' }, ticks: { color: '#fff' } }
                    }
                }
            });

            // Historical Trend Chart
            const historicalCtx = document.getElementById('historicalTrendChart').getContext('2d');
            new Chart(historicalCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 15}, (_, i) => i),
                    datasets: [{
                        label: 'Changeover Times',
                        data: Array.from({length: 15}, () => Math.random() * 5 + 2),
                        borderColor: '#ff8c00',
                        tension: 0.4,
                        fill: false
                    },
                    {
                        label: 'Machine Idle Time',
                        data: Array.from({length: 15}, () => Math.random() * 3 + 1),
                        borderColor: '#666',
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { 
                        legend: { 
                            display: true,
                            labels: { color: '#fff' }
                        }
                    },
                    scales: {
                        y: { grid: { color: '#333' }, ticks: { color: '#fff' } },
                        x: { grid: { color: '#333' }, ticks: { color: '#fff' } }
                    }
                }
            });

            // Energy Cost Chart
            const energyCtx = document.getElementById('energyCostChart').getContext('2d');
            new Chart(energyCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 200}, (_, i) => i),
                    datasets: [{
                        data: Array.from({length: 200}, () => Math.random() * 2 + 1),
                        borderColor: '#ff8c00',
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: '#333' }, ticks: { color: '#fff' } },
                        x: { grid: { color: '#333' }, ticks: { color: '#fff' } }
                    }
                }
            });
        }

        function updateMachineAnalytics(chartType = 'products') {
            if (!currentMachine) return;
            
            const machineEntries = dataEntries.filter(e => e.machineId === currentMachine.id);
            
            if (machineEntries.length === 0) {
                document.getElementById('machineChart').closest('.chart-container').innerHTML = `
                    <div class="empty-state">${translations[currentLanguage].no_data_available || 'No data available for analytics'}</div>
                `;
                return;
            }
            
            // Sort entries by date
            machineEntries.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Prepare data for chart
            const labels = machineEntries.map(entry => formatDate(entry.date, false, true));
            const productsData = machineEntries.map(entry => entry.productsManufactured);
            const hoursData = machineEntries.map(entry => entry.workingHours);
            const efficiencyData = machineEntries.map(entry => parseFloat(entry.efficiency));
            
            // Get canvas element
            const ctx = document.getElementById('machineChart');
            
            // Destroy previous chart if exists
            if (machineChart) {
                machineChart.destroy();
            }
            
            // Create new chart
            machineChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: chartType === 'products' ? translations[currentLanguage].products_manufactured || 'Products Manufactured' : 
                               chartType === 'hours' ? translations[currentLanguage].working_hours || 'Working Hours' : 
                               translations[currentLanguage].efficiency || 'Efficiency (Products/Hour)',
                        data: chartType === 'products' ? productsData : 
                              chartType === 'hours' ? hoursData : efficiencyData,
                        borderColor: '#ff8c00',
                        backgroundColor: 'rgba(255, 140, 0, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#999999'
                            },
                            grid: {
                                color: '#333333'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#999999'
                            },
                            grid: {color: '#333333'
                        }
                    }
                }
            }
        });
    }

    function updateOperatorsView() {
        const container = document.getElementById('operatorsGrid');
        container.innerHTML = '';
        
        if (Object.keys(operators).length === 0) {
            container.innerHTML = `<div class="empty-state">${translations[currentLanguage].no_operators_found || 'No operators found'}</div>`;
            return;
        }
        
        Object.entries(operators).forEach(([name, data]) => {
            const efficiency = data.totalHours > 0 ? (data.totalProducts / data.totalHours).toFixed(2) : 0;
            const badgeLevel = getBadgeLevel(data.totalHours);
            
            const operatorCard = document.createElement('div');
            operatorCard.className = 'operator-card';
            operatorCard.innerHTML = `
                <div class="operator-header">
                    <h3 class="operator-name">${name}</h3>
                    <div class="operator-badge ${badgeLevel.class}">
                        <i class="fas ${badgeLevel.icon}"></i>
                        <span>${badgeLevel.name}</span>
                    </div>
                </div>
                <div class="operator-stats">
                    <div class="operator-stat">
                        <div class="operator-stat-value">${data.totalHours.toFixed(1)}h</div>
                        <div class="operator-stat-label">${translations[currentLanguage].total_hours || 'Total Hours'}</div>
                    </div>
                    <div class="operator-stat">
                        <div class="operator-stat-value">${data.totalProducts}</div>
                        <div class="operator-stat-label">${translations[currentLanguage].total_products || 'Total Products'}</div>
                    </div>
                    <div class="operator-stat">
                        <div class="operator-stat-value">${efficiency}</div>
                        <div class="operator-stat-label">${translations[currentLanguage].efficiency || 'Efficiency'}</div>
                    </div>
                </div>
                <button class="btn btn-outline view-operator-btn">
                    <i class="fas fa-user"></i> ${translations[currentLanguage].view_details || 'View Details'}
                </button>
            `;
            
            operatorCard.querySelector('.view-operator-btn').addEventListener('click', () => {
                showOperatorDetails(name);
            });
            
            container.appendChild(operatorCard);
        });
    }

    function updateAnalyticsPage(range = '7d') {
        if (dataEntries.length === 0) {
            document.querySelectorAll('.analytics-stats-grid .stat-value').forEach(el => {
                el.textContent = '0';
            });
            
            document.querySelectorAll('.chart-card canvas').forEach(canvas => {
                canvas.closest('.chart-card').innerHTML = `
                    <div class="empty-state">${translations[currentLanguage].no_data_available || 'No data available for analytics'}</div>
                `;
            });
            
            return;
        }
        
        // Calculate date range
        const endDate = new Date();
        let startDate = new Date();
        
        switch (range) {
            case '7d':
                startDate.setDate(endDate.getDate() - 7);
                break;
            case '30d':
                startDate.setDate(endDate.getDate() - 30);
                break;
            case '90d':
                startDate.setDate(endDate.getDate() - 90);
                break;
            case 'all':
                startDate = new Date(Math.min(...dataEntries.map(e => new Date(e.date))));
                break;
        }
        
        // Filter entries by date range
        const filteredEntries = dataEntries.filter(e => {
            const entryDate = new Date(e.date);
            return entryDate >= startDate && entryDate <= endDate;
        });
        
        // Update stats
        document.getElementById('analyticsTotalMachines').textContent = machines.length;
        document.getElementById('analyticsActiveMachines').textContent = machines.filter(m => m.status === 'active').length;
        
        const totalProducts = filteredEntries.reduce((sum, entry) => sum + entry.productsManufactured, 0);
        document.getElementById('analyticsTotalProducts').textContent = totalProducts;
        
        const totalHours = filteredEntries.reduce((sum, entry) => sum + entry.workingHours, 0);
        document.getElementById('analyticsTotalHours').textContent = `${totalHours.toFixed(1)}h`;
        
        const totalEntries = filteredEntries.length;
        document.getElementById('analyticsTotalEntries').textContent = totalEntries;
        
        const avgEfficiency = totalHours > 0 ? (totalProducts / totalHours).toFixed(2) : 0;
        document.getElementById('analyticsAvgEfficiency').textContent = avgEfficiency;
        
        // Update time series chart
        updateTimeSeriesChart('products', filteredEntries);
        
        // Update machine type chart
        updateMachineTypeChart(filteredEntries);
        
        // Update top machines table
        updateTopMachinesTable(filteredEntries);
    }

    function updateTimeSeriesChart(metric = 'products', entries = dataEntries) {
        // Group entries by date
        const entriesByDate = {};
        
        entries.forEach(entry => {
            if (!entriesByDate[entry.date]) {
                entriesByDate[entry.date] = {
                    products: 0,
                    hours: 0,
                    count: 0
                };
            }
            
            entriesByDate[entry.date].products += entry.productsManufactured;
            entriesByDate[entry.date].hours += entry.workingHours;
            entriesByDate[entry.date].count++;
        });
        
        // Sort dates
        const sortedDates = Object.keys(entriesByDate).sort((a, b) => new Date(a) - new Date(b));
        
        // Prepare data
        const labels = sortedDates.map(date => formatDate(date, false, true));
        const productsData = sortedDates.map(date => entriesByDate[date].products);
        const hoursData = sortedDates.map(date => entriesByDate[date].hours);
        const efficiencyData = sortedDates.map(date => 
            entriesByDate[date].hours > 0 ? (entriesByDate[date].products / entriesByDate[date].hours).toFixed(2) : 0
        );
        
        // Get canvas element
        const canvas = document.getElementById('timeSeriesChart');
        
        // Destroy previous chart if exists
        if (timeSeriesChart) {
            timeSeriesChart.destroy();
        }
        
        // Create new chart
        timeSeriesChart = new Chart(canvas, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: metric === 'products' ? translations[currentLanguage].products_manufactured || 'Products Manufactured' : 
                           metric === 'hours' ? translations[currentLanguage].working_hours || 'Working Hours' : 
                           translations[currentLanguage].efficiency || 'Efficiency (Products/Hour)',
                    data: metric === 'products' ? productsData : 
                          metric === 'hours' ? hoursData : efficiencyData,
                    borderColor: '#ff8c00',
                    backgroundColor: 'rgba(255, 140, 0, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: {
                            color: '#ffffff'
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            color: '#999999'
                        },
                        grid: {
                            color: '#333333'
                        }
                    },
                    y: {
                        ticks: {
                            color: '#999999'
                        },
                        grid: {
                            color: '#333333'
                        }
                    }
                }
            }
        });
    }

    function updateMachineTypeChart(entries = dataEntries) {
        // Group entries by machine type
        const typeStats = {};
        
        machines.forEach(machine => {
            if (!typeStats[machine.type]) {
                typeStats[machine.type] = {
                    products: 0,
                    hours: 0,
                    count: 0
                };
            }
        });
        
        entries.forEach(entry => {
            const machine = machines.find(m => m.id === entry.machineId);
            if (machine && typeStats[machine.type]) {
                typeStats[machine.type].products += entry.productsManufactured;
                typeStats[machine.type].hours += entry.workingHours;
                typeStats[machine.type].count++;
            }
        });
        
        // Prepare data
        const labels = Object.keys(typeStats);
        const productsData = labels.map(type => typeStats[type].products);
        const hoursData = labels.map(type => typeStats[type].hours);
        const efficiencyData = labels.map(type => 
            typeStats[type].hours > 0 ? (typeStats[type].products / typeStats[type].hours).toFixed(2) : 0
        );
        
        // Get canvas element
        const canvas = document.getElementById('machineTypeChart');
        
        // Destroy previous chart if exists
        if (machineTypeChart) {
            machineTypeChart.destroy();
        }
        
        // Create new chart
        machineTypeChart = new Chart(canvas, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: translations[currentLanguage].products_manufactured || 'Products Manufactured',
                    data: productsData,
                    backgroundColor: '#ff8c00'
                }, {
                    label: translations[currentLanguage].working_hours || 'Working Hours',
                    data: hoursData,
                    backgroundColor: '#333333'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: {
                            color: '#ffffff'
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            color: '#999999'
                        },
                        grid: {
                            color: '#333333'
                        }
                    },
                    y: {
                        ticks: {
                            color: '#999999'
                        },
                        grid: {
                            color: '#333333'
                        }
                    }
                }
            }
        });
    }

    function updateTopMachinesTable(entries = dataEntries) {
        // Group entries by machine
        const machineStats = {};
        
        machines.forEach(machine => {
            machineStats[machine.id] = {
                name: machine.name,
                type: machine.type,
                products: 0,
                hours: 0,
                entries: 0
            };
        });
        
        entries.forEach(entry => {
            if (machineStats[entry.machineId]) {
                machineStats[entry.machineId].products += entry.productsManufactured;
                machineStats[entry.machineId].hours += entry.workingHours;
                machineStats[entry.machineId].entries++;
            }
        });
        
        // Convert to array and sort by efficiency
        const sortedMachines = Object.values(machineStats)
            .filter(m => m.entries > 0)
            .map(m => ({
                ...m,
                efficiency: m.hours > 0 ? (m.products / m.hours).toFixed(2) : 0
            }))
            .sort((a, b) => b.efficiency - a.efficiency)
            .slice(0, 10); // Top 10 machines
        
        // Update table
        const tableBody = document.querySelector('#topMachinesTable tbody');
        tableBody.innerHTML = '';
        
        if (sortedMachines.length === 0) {
            tableBody.innerHTML = `
                <tr>
                    <td colspan="6" class="empty-table">${translations[currentLanguage].no_data_available || 'No data available'}</td>
                </tr>
            `;
            return;
        }
        
        sortedMachines.forEach(machine => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${machine.name}</td>
                <td>${machine.type}</td>
                <td>${machine.products}</td>
                <td>${machine.hours.toFixed(1)}h</td>
                <td>${machine.efficiency}</td>
                <td>${machine.entries}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Helper Functions
    function getBadgeLevel(hours) {
        const levels = [
            { threshold: 0, class: 'badge-trainee', icon: 'fa-user-graduate', name: translations[currentLanguage]?.operator_levels?.trainee || 'Trainee Operator' },
            { threshold: 50, class: 'badge-skilled', icon: 'fa-user', name: translations[currentLanguage]?.operator_levels?.skilled || 'Skilled Handler' },
            { threshold: 200, class: 'badge-precision', icon: 'fa-bullseye', name: translations[currentLanguage]?.operator_levels?.precision || 'Precision Pro' },
            { threshold: 500, class: 'badge-veteran', icon: 'fa-user-tie', name: translations[currentLanguage]?.operator_levels?.veteran || 'Floor Veteran' },
            { threshold: 1000, class: 'badge-whisperer', icon: 'fa-magic', name: translations[currentLanguage]?.operator_levels?.whisperer || 'Machine Whisperer' },
            { threshold: 2000, class: 'badge-master', icon: 'fa-crown', name: translations[currentLanguage]?.operator_levels?.master || 'Master of Motion' },
            { threshold: 5000, class: 'badge-champion', icon: 'fa-trophy', name: translations[currentLanguage]?.operator_levels?.champion || 'Efficiency Champion' },
            { threshold: 10000, class: 'badge-legendary', icon: 'fa-star', name: translations[currentLanguage]?.operator_levels?.legendary || 'Legendary Operator' }
        ];
        
        // Find the highest level the operator qualifies for
        let level = levels[0];
        for (let i = levels.length - 1; i >= 0; i--) {
            if (hours >= levels[i].threshold) {
                level = levels[i];
                break;
            }
        }
        
        return level;
    }

    function formatDate(dateString, includeTime = false, short = false) {
        const date = new Date(dateString);
        
        if (short) {
            return date.toLocaleDateString(currentLanguage, { month: 'short', day: 'numeric' });
        }
        
        return date.toLocaleDateString(currentLanguage, {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            ...(includeTime && {
                hour: '2-digit',
                minute: '2-digit'
            })
        });
    }

    function generateId() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    function showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
            <span>${message}</span>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.classList.add('show');
        }, 10);
        
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
    }

    // Data Persistence
    function loadDataFromStorage() {
        const savedMachines = localStorage.getItem('machines');
        if (savedMachines) {
            machines = JSON.parse(savedMachines);
        }
        
        const savedEntries = localStorage.getItem('dataEntries');
        if (savedEntries) {
            dataEntries = JSON.parse(savedEntries);
        }
        
        const savedOperators = localStorage.getItem('operators');
        if (savedOperators) {
            operators = JSON.parse(savedOperators);
        }
    }

    function saveDataToStorage() {
        localStorage.setItem('machines', JSON.stringify(machines));
        localStorage.setItem('dataEntries', JSON.stringify(dataEntries));
        localStorage.setItem('operators', JSON.stringify(operators));
    }
</script>
<script>
    
// Show stats page when button is clicked
document.getElementById('statsBtn').addEventListener('click', function() {
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('insightsPage').style.display = 'none';
    document.getElementById('statsPage').style.display = 'block';
});

// Back button for stats page
document.getElementById('backToMainFromStats').addEventListener('click', function() {
    document.getElementById('statsPage').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
});

// Ensure DOM is fully loaded before attaching event listeners
document.addEventListener('DOMContentLoaded', function () {
    const backBtn = document.getElementById('backToMainFromStats');
    const statsPage = document.getElementById('statsPage');
    const mainContent = document.getElementById('mainContent');

    if (backBtn && statsPage && mainContent) {
        backBtn.addEventListener('click', function () {
            statsPage.style.display = 'none';
            mainContent.style.display = 'block';
        });
    } else {
        console.warn('One or more elements are missing in the DOM.');
    }
});


// Render all stats charts with proper configuration
function renderStatsCharts() {
    const chartConfigs = {
        'shiftDelayHistoryChart': {
            type: 'bar',
            data: {
                labels: ['4/1', '4/1', '4/1', '4/1', '4/5', '4/1', '4/10', '4/10'],
                datasets: [{
                    label: 'Shift A',
                    data: [32, 30, 28, 30, 28, 25, 22, 20],
                    backgroundColor: '#FFC107',
                    barPercentage: 0.4
                },
                {
                    label: 'Shift B',
                    data: [25, 22, 25, 20, 20, 18, 15, 8],
                    backgroundColor: '#666666',
                    barPercentage: 0.4
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 40,
                        ticks: {
                            stepSize: 10
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                }
            }
        },
        'energyCostChart': {
            type: 'bar',
            data: {
                labels: ['Jan','Feb','Mar','Apr','May','Jun','Sep'],
                datasets: [{
                    data: [2,3,2.5,3.5,2.8,3.2,3.8],
                    backgroundColor: '#FFC107'
                }]
            }
        },
        'shiftDelayChart': {
            type: 'line',
            data: {
                labels: ['Mon','Tue','Wed','Thu','Fri'],
                datasets: [{
                    data: [4,3,5,2,4],
                    borderColor: '#FFC107',
                    tension: 0.4,
                    fill: false
                }]
            }
        },
        'changeoverDelayChart': {
            type: 'bar',
            data: {
                labels: ['Mon','Tue','Wed','Thu','Fri'],
                datasets: [{
                    data: [15,12,18,10,14],
                    backgroundColor: '#FFC107'
                }]
            }
        },
        'grindingCycleChart': {
            type: 'line',
            data: {
                labels: ['Shift A','Shift B','Shift C'],
                datasets: [{
                    data: [85,78,82],
                    borderColor: '#FFC107',
                    tension: 0.4,
                    fill: false
                }]
            }
        }
    };

    // Common options for all charts
    const commonOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            x: {
                ticks: {
                    color: '#FFC107'
                },
                grid: {
                    color: 'rgba(255, 193, 7, 0.1)'
                }
            },
            y: {
                ticks: {
                    color: '#FFC107'
                },
                grid: {
                    color: 'rgba(255, 193, 7, 0.1)'
                }
            }
        }
    };

    // Initialize all charts
    Object.entries(chartConfigs).forEach(([chartId, config]) => {
        const canvas = document.getElementById(chartId);
        if (canvas) {
            const ctx = canvas.getContext('2d');
            new Chart(ctx, {
                ...config,
                options: commonOptions
            });
        }
    });
}
document.addEventListener('DOMContentLoaded', renderStatsCharts);
</script>
<!-- Settings Modal -->
<div class="modal fade" id="settingsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">${translations[currentLanguage].settings || 'Settings'}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">${translations[currentLanguage].language || 'Language'}</label>
                    <select class="form-select" id="languageSelect">
                        <option value="en">English</option>
                        <option value="es">Español</option>
                        <option value="fr">Français</option>
                        <option value="de">Deutsch</option>
                        <option value="ja">日本語</option>
                        <option value="zh">中文</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">${translations[currentLanguage].theme || 'Theme'}</label>
                    <select class="form-select" id="themeSelect">
                        <option value="dark">Dark</option>
                        <option value="light">Light</option>
                        <option value="system">System Default</option>
                    </select>
                </div>
                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="notificationsToggle">
                    <label class="form-check-label" for="notificationsToggle">${translations[currentLanguage].enable_notifications || 'Enable Notifications'}</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">${translations[currentLanguage].close || 'Close'}</button>
                <button type="button" class="btn btn-primary" id="saveSettingsBtn">${translations[currentLanguage].save_settings || 'Save Settings'}</button>
            </div>
        </div>
    </div>
</div>

<!-- Export/Import Modal -->
<div class="modal fade" id="dataModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">${translations[currentLanguage].data_management || 'Data Management'}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <ul class="nav nav-tabs" id="dataTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="export-tab" data-bs-toggle="tab" data-bs-target="#export-tab-pane" type="button" role="tab">
                            ${translations[currentLanguage].export_data || 'Export Data'}
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="import-tab" data-bs-toggle="tab" data-bs-target="#import-tab-pane" type="button" role="tab">
                            ${translations[currentLanguage].import_data || 'Import Data'}
                        </button>
                    </li>
                </ul>
                <div class="tab-content p-3" id="dataTabsContent">
                    <div class="tab-pane fade show active" id="export-tab-pane" role="tabpanel">
                        <p>${translations[currentLanguage].export_description || 'Export all your data as a JSON file for backup or transfer.'}</p>
                        <div class="d-flex gap-2">
                            <button class="btn btn-primary" id="exportAllBtn">
                                <i class="fas fa-download"></i> ${translations[currentLanguage].export_all || 'Export All'}
                            </button>
                            <button class="btn btn-outline-primary" id="exportEntriesBtn">
                                ${translations[currentLanguage].export_entries || 'Export Entries'}
                            </button>
                            <button class="btn btn-outline-primary" id="exportMachinesBtn">
                                ${translations[currentLanguage].export_machines || 'Export Machines'}
                            </button>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="import-tab-pane" role="tabpanel">
                        <p>${translations[currentLanguage].import_description || 'Import data from a previously exported JSON file.'}</p>
                        <div class="mb-3">
                            <label for="importFile" class="form-label">${translations[currentLanguage].select_file || 'Select JSON file'}</label>
                            <input class="form-control" type="file" id="importFile" accept=".json">
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="overwriteData" checked>
                            <label class="form-check-label" for="overwriteData">
                                ${translations[currentLanguage].overwrite_existing || 'Overwrite existing data'}
                            </label>
                        </div>
                        <button class="btn btn-primary" id="importBtn" disabled>
                            <i class="fas fa-upload"></i> ${translations[currentLanguage].import_data || 'Import Data'}
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">${translations[currentLanguage].close || 'Close'}</button>
            </div>
        </div>
    </div>
</div>

<!-- Help Modal -->
<div class="modal fade" id="helpModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">${translations[currentLanguage].help || 'Help & Documentation'}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="accordion" id="helpAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#helpGettingStarted">
                                ${translations[currentLanguage].getting_started || 'Getting Started'}
                            </button>
                        </h2>
                        <div id="helpGettingStarted" class="accordion-collapse collapse show" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                <p>${translations[currentLanguage].getting_started_content || 'To start tracking manufacturing efficiency, follow these steps:'}</p>
                                <ol>
                                    <li>${translations[currentLanguage].step1 || 'Add your machines in the Machines section'}</li>
                                    <li>${translations[currentLanguage].step2 || 'Record production data using the New Entry form'}</li>
                                    <li>${translations[currentLanguage].step3 || 'View analytics and operator performance in the respective sections'}</li>
                                    <li>${translations[currentLanguage].step4 || 'Use the data to identify efficiency improvements'}</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#helpEfficiency">
                                ${translations[currentLanguage].understanding_efficiency || 'Understanding Efficiency'}
                            </button>
                        </h2>
                        <div id="helpEfficiency" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                <p>${translations[currentLanguage].efficiency_explanation || 'Efficiency is calculated as the number of products manufactured per hour of operation. Higher values indicate more efficient production.'}</p>
                                <p><strong>${translations[currentLanguage].formula || 'Formula'}:</strong> Efficiency = Total Products / Total Hours</p>
                                <p>${translations[currentLanguage].efficiency_tips || 'Tips to improve efficiency:'}</p>
                                <ul>
                                    <li>${translations[currentLanguage].tip1 || 'Regular machine maintenance'}</li>
                                    <li>${translations[currentLanguage].tip2 || 'Operator training and cross-training'}</li>
                                    <li>${translations[currentLanguage].tip3 || 'Optimize production schedules'}</li>
                                    <li>${translations[currentLanguage].tip4 || 'Identify and address bottlenecks'}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#helpBadges">
                                ${translations[currentLanguage].operator_badges || 'Operator Badges'}
                            </button>
                        </h2>
                        <div id="helpBadges" class="accordion-collapse collapse" data-bs-parent="#helpAccordion">
                            <div class="accordion-body">
                                <p>${translations[currentLanguage].badges_explanation || 'Operators earn badges based on their total logged hours, recognizing their experience and skill level.'}</p>
                                <div class="badges-list">
                                    <div class="badge-item">
                                        <div class="operator-badge badge-trainee">
                                            <i class="fas fa-user-graduate"></i>
                                            <span>${translations[currentLanguage]?.operator_levels?.trainee || 'Trainee Operator'}</span>
                                        </div>
                                        <div class="badge-description">0-49 hours</div>
                                    </div>
                                    <div class="badge-item">
                                        <div class="operator-badge badge-skilled">
                                            <i class="fas fa-user"></i>
                                            <span>${translations[currentLanguage]?.operator_levels?.skilled || 'Skilled Handler'}</span>
                                        </div>
                                        <div class="badge-description">50-199 hours</div>
                                    </div>
                                    <!-- More badge levels would be listed here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">${translations[currentLanguage].close || 'Close'}</button>
            </div>
        </div>
    </div>
</div>

<!-- Event Listeners and Initialization -->
<script>
    // Initialize the application when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        // Load translations and data
        loadTranslations();
        loadDataFromStorage();
        
        // Initialize UI components
        initModals();
        initForms();
        initEventListeners();
        
        // Show dashboard by default
        showSection('dashboard');
        
        // Update all views
        updateDashboard();
        updateMachinesView();
        updateEntriesView();
        updateOperatorsView();
        updateAnalyticsPage();
    });

    function initModals() {
        // Initialize Bootstrap modals
        const modalElements = document.querySelectorAll('.modal');
        modalElements.forEach(modalEl => {
            new bootstrap.Modal(modalEl);
        });
    }

    function initForms() {
        // Machine type autocomplete
        const machineTypeInput = document.getElementById('machineType');
        if (machineTypeInput) {
            machineTypeInput.addEventListener('input', function() {
                const value = this.value.toLowerCase();
                const uniqueTypes = [...new Set(machines.map(m => m.type))];
                const filteredTypes = uniqueTypes.filter(type => 
                    type.toLowerCase().includes(value)
                );
                
                // Show/hide suggestions
                // Implementation would go here
            });
        }
        
        // Date picker initialization
        const dateInputs = document.querySelectorAll('input[type="date"]');
        dateInputs.forEach(input => {
            if (!input.value) {
                const today = new Date().toISOString().split('T')[0];
                input.value = today;
            }
        });
    }

    function initEventListeners() {
        // Navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const sectionId = this.getAttribute('data-section');
                showSection(sectionId);
            });
        });
        
        // Settings modal
        document.getElementById('settingsBtn').addEventListener('click', function() {
            // Load current settings
            document.getElementById('languageSelect').value = currentLanguage;
            // Other settings would be loaded here
        });
        
        // Save settings
        document.getElementById('saveSettingsBtn').addEventListener('click', function() {
            const newLanguage = document.getElementById('languageSelect').value;
            if (newLanguage !== currentLanguage) {
                currentLanguage = newLanguage;
                loadTranslations();
                updateUIAfterLanguageChange();
            }
            
            // Save other settings
            const theme = document.getElementById('themeSelect').value;
            applyTheme(theme);
            
            localStorage.setItem('settings', JSON.stringify({
                language: currentLanguage,
                theme: theme,
                notifications: document.getElementById('notificationsToggle').checked
            }));
            
            showNotification(translations[currentLanguage].settings_saved || 'Settings saved successfully');
            bootstrap.Modal.getInstance(document.getElementById('settingsModal')).hide();
        });
        
        // Data export buttons
        document.getElementById('exportAllBtn').addEventListener('click', exportAllData);
        document.getElementById('exportEntriesBtn').addEventListener('click', exportEntriesData);
        document.getElementById('exportMachinesBtn').addEventListener('click', exportMachinesData);
        
        // Data import
        document.getElementById('importFile').addEventListener('change', function() {
            document.getElementById('importBtn').disabled = !this.files.length;
        });
        
        document.getElementById('importBtn').addEventListener('click', importData);
    }

    function exportAllData() {
        const data = {
            machines: machines,
            dataEntries: dataEntries,
            operators: operators,
            exportedAt: new Date().toISOString()
        };
        
        downloadJSON(data, 'manufacturing_efficiency_export_all.json');
        showNotification(translations[currentLanguage].export_success || 'Data exported successfully');
    }

    function exportEntriesData() {
        const data = {
            dataEntries: dataEntries,
            exportedAt: new Date().toISOString()
        };
        
        downloadJSON(data, 'manufacturing_efficiency_entries.json');
        showNotification(translations[currentLanguage].entries_exported || 'Entries exported successfully');
    }

    function exportMachinesData() {
        const data = {
            machines: machines,
            exportedAt: new Date().toISOString()
        };
        
        downloadJSON(data, 'manufacturing_efficiency_machines.json');
        showNotification(translations[currentLanguage].machines_exported || 'Machines exported successfully');
    }

    function importData() {
        const fileInput = document.getElementById('importFile');
        const overwrite = document.getElementById('overwriteData').checked;
        
        if (!fileInput.files.length) return;
        
        const file = fileInput.files[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);
                let importedCount = 0;
                
                if (overwrite) {
                    if (data.machines) {
                        machines = data.machines;
                        importedCount += machines.length;
                    }
                    if (data.dataEntries) {
                        dataEntries = data.dataEntries;
                        importedCount += dataEntries.length;
                    }
                    if (data.operators) {
                        operators = data.operators;
                        importedCount += Object.keys(operators).length;
                    }
                } else {
                    if (data.machines) {
                        data.machines.forEach(newMachine => {
                            if (!machines.some(m => m.id === newMachine.id)) {
                                machines.push(newMachine);
                                importedCount++;
                            }
                        });
                    }
                    if (data.dataEntries) {
                        data.dataEntries.forEach(newEntry => {
                            if (!dataEntries.some(e => e.id === newEntry.id)) {
                                dataEntries.push(newEntry);
                                importedCount++;
                            }
                        });
                    }
                    if (data.operators) {
                        Object.entries(data.operators).forEach(([name, operatorData]) => {
                            if (!operators[name]) {
                                operators[name] = operatorData;
                                importedCount++;
                            }
                        });
                    }
                }
                
                saveDataToStorage();
                updateAllViews();
                
                showNotification(
                    translations[currentLanguage].import_success 
                    ? translations[currentLanguage].import_success.replace('{count}', importedCount)
                    : `${importedCount} items imported successfully`
                );
                
                bootstrap.Modal.getInstance(document.getElementById('dataModal')).hide();
            } catch (error) {
                showNotification(
                    translations[currentLanguage].import_error || 'Error importing data: Invalid file format',
                    'error'
                );
                console.error('Import error:', error);
            }
        };
        
        reader.readAsText(file);
    }

    function downloadJSON(data, filename) {
        const dataStr = JSON.stringify(data, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    }

    function applyTheme(theme) {
        // Implementation would set the appropriate theme classes
        // and store the preference in localStorage
    }

    function updateUIAfterLanguageChange() {
        // Update all text elements with new translations
        document.querySelectorAll('[data-translate]').forEach(el => {
            const key = el.getAttribute('data-translate');
            if (translations[currentLanguage] && translations[currentLanguage][key]) {
                el.textContent = translations[currentLanguage][key];
            }
        });
        
        // Update form placeholders, labels, etc.
        // This would be more comprehensive in a real implementation
        
        // Update all views to reflect language changes
        updateAllViews();
    }

    function updateAllViews() {
        updateDashboard();
        updateMachinesView();
        updateEntriesView();
        updateOperatorsView();
        updateAnalyticsPage();
    }

    // Load translations (simplified example)
    function loadTranslations() {
        // In a real app, this would load from external files
        translations = {
            en: {
                dashboard: 'Dashboard',
                machines: 'Machines',
                entries: 'Production Entries',
                operators: 'Operators',
                analytics: 'Analytics',
                // ... all other English translations
            },
            es: {
                dashboard: 'Panel',
                machines: 'Máquinas',
                entries: 'Entradas de Producción',
                operators: 'Operadores',
                analytics: 'Análisis',
                // ... all other Spanish translations
            }
            // Other languages would follow
        };
    }
</script>

<!-- Footer -->
<footer class="app-footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <p>${translations[currentLanguage].app_name || 'Manufacturing Efficiency Tracker'} v1.0.0</p>
            </div>
            <div class="col-md-6 text-end">
                <p>${translations[currentLanguage].copyright || '© 2023 Manufacturing Solutions. All rights reserved.'}</p>
            </div>
        </div>
    </div>
</footer>